<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Concise Selector for Endorsements and Reference Values</title>
<meta content="Paul Howard" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Shefali Kamal" name="author">
<meta content="Giridhar Mandyam" name="author">
<meta content="Ding Ma" name="author">
<meta content="
       In the Remote Attestation Procedures (RATS) architecture, Verifiers require Endorsements and Reference Values to assess the trustworthiness of Attesters.
This document specifies the Concise Selector for Endorsements and Reference Values (CoSERV), a structured query/result format designed to facilitate the discovery and retrieval of these artifacts from various providers.
CoSERV defines a query language and corresponding result structure using CDDL, which can be serialized in CBOR format, enabling efficient interoperability across diverse systems. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="RATS" name="keyword">
<meta content="attestation" name="keyword">
<meta content="endorsement" name="keyword">
<meta content="reference value" name="keyword">
<meta content="draft-ietf-rats-coserv-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-ietf-rats-coserv.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CoSERV</td>
<td class="right">March 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Howard, et al.</td>
<td class="center">Expires 3 September 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Remote ATtestation ProcedureS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-rats-coserv-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-03-02" class="published">2 March 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-09-03">3 September 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Howard</div>
<div class="org">Arm</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Linaro</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">S. Kamal</div>
<div class="org">Fujitsu</div>
</div>
<div class="author">
      <div class="author-name">G. Mandyam</div>
<div class="org">AMD</div>
</div>
<div class="author">
      <div class="author-name">D. Ma</div>
<div class="org">Alibaba Cloud</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Concise Selector for Endorsements and Reference Values</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">In the Remote Attestation Procedures (RATS) architecture, Verifiers require Endorsements and Reference Values to assess the trustworthiness of Attesters.
This document specifies the Concise Selector for Endorsements and Reference Values (CoSERV), a structured query/result format designed to facilitate the discovery and retrieval of these artifacts from various providers.
CoSERV defines a query language and corresponding result structure using CDDL, which can be serialized in CBOR format, enabling efficient interoperability across diverse systems.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-rats-wg.github.io/draft-ietf-rats-coserv/draft-ietf-rats-coserv.html">https://ietf-rats-wg.github.io/draft-ietf-rats-coserv/draft-ietf-rats-coserv.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-rats-coserv/">https://datatracker.ietf.org/doc/draft-ietf-rats-coserv/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Remote ATtestation ProcedureS Working Group mailing list (<span><a href="mailto:rats@ietf.org">mailto:rats@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/rats/">https://mailarchive.ietf.org/arch/browse/rats/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/rats/">https://www.ietf.org/mailman/listinfo/rats/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-rats-wg/draft-ietf-rats-coserv">https://github.com/ietf-rats-wg/draft-ietf-rats-coserv</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 September 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology-and-requirement" class="internal xref">Terminology and Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-aggregation-and-trust-model" class="internal xref">Aggregation and Trust Models</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-coserv-information-model" class="internal xref">CoSERV Information Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-artifacts" class="internal xref">Artifacts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-environments" class="internal xref">Environments</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-stateful-environments" class="internal xref">Stateful Environments</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-queries" class="internal xref">Queries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-result-sets" class="internal xref">Result Sets</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-coserv-data-model" class="internal xref">CoSERV Data Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-common-data-types" class="internal xref">Common Data Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-profile" class="internal xref">Profile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-query-structure" class="internal xref">Query Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-artifact-type" class="internal xref">Artifact Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-environment-selector" class="internal xref">Environment Selector</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="auto internal xref">4.3.3</a>.  <a href="#name-result-type" class="internal xref">Result Type</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-result-set-structure" class="internal xref">Result Set Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-encoding-requirements" class="internal xref">Encoding Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-cryptographic-binding-betwe" class="internal xref">Cryptographic Binding Between Query and Result Set</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-query-data-examples" class="internal xref">Query Data Examples</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-result-data-examples" class="internal xref">Result Data Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-api-bindings" class="internal xref">API Bindings</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-request-response-over-http" class="internal xref">Request Response over HTTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-discovery" class="internal xref">Discovery</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-execute-query" class="internal xref">Execute Query</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-caching" class="internal xref">Caching</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-veraison" class="internal xref">Veraison</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-in-relation-to-corim" class="internal xref">In Relation to CoRIM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-forming-native-database-que" class="internal xref">Forming Native Database Queries from CoSERV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-aggregators" class="internal xref">Aggregators</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-aggregators-2" class="internal xref">Aggregators</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-media-types-registrations" class="internal xref">Media Types Registrations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#section-10.1.1" class="auto internal xref">10.1.1</a>.  <a href="#name-application-coservcbor" class="internal xref"><code>application/coserv+cbor</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#section-10.1.2" class="auto internal xref">10.1.2</a>.  <a href="#name-application-coservcose" class="internal xref"><code>application/coserv+cose</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.3">
                    <p id="section-toc.1-1.10.2.1.2.3.1"><a href="#section-10.1.3" class="auto internal xref">10.1.3</a>.  <a href="#name-application-coserv-discover" class="internal xref"><code>application/coserv-discovery+cbor</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.4">
                    <p id="section-toc.1-1.10.2.1.2.4.1"><a href="#section-10.1.4" class="auto internal xref">10.1.4</a>.  <a href="#name-application-coserv-discovery" class="internal xref"><code>application/coserv-discovery+json</code></a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-coap-content-formats" class="internal xref">CoAP Content-Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-well-known-uri-for-coserv-c" class="internal xref">Well-Known URI for CoSERV Configuration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-collated-cddl" class="internal xref">Collated CDDL</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-coserv-data-model-2" class="internal xref">CoSERV Data Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-api-discovery-data-model" class="internal xref">API Discovery Data Model</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-openapi-schema" class="internal xref">OpenAPI Schema</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-locating-coserv-services" class="internal xref">Locating CoSERV Services</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Remote Attestation Procedures (RATS) enable Relying Parties to evaluate the trustworthiness of remote Attesters by appraising Evidence.
This appraisal necessitates access to Endorsements and Reference Values, which are often distributed across multiple providers, including hardware manufacturers, firmware developers, and software vendors.
The lack of standardized methods for querying and retrieving these artifacts poses challenges in achieving seamless interoperability.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The Concise Selector for Endorsements and Reference Values (CoSERV) addresses this challenge by defining a query language and a corresponding result structure for the transaction of artifacts between a provider and a consumer.
The query language format provides Verifiers with a standard way to specify the environment characteristics of Attesters, such that the relevant artifacts can be obtained from Endorsers and Reference Value Providers.
In turn, the result format allows those Endorsers and Reference Value Providers to package the artifacts within a standard structure.
This facilitates the efficient discovery and retrieval of relevant Endorsements and Reference Values from providers, maximising the re-use of common software tools and libraries within the transactions.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The CoSERV query language is intended to form the input data type for tools and services that provide access to Endorsements and Reference Values.
The CoSERV result set is intended to form the corresponding output data type from those tools and services.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The environment characteristics of Endorsements and Reference Values are derived from the equivalent concepts in CoRIM <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>.
CoSERV therefore borrows heavily from CoRIM, and shares some data types for its fields.
And, like CoRIM, the CoSERV schema is defined using CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>. A CoSERV query can be serialized in CBOR <span>[<a href="#STD94" class="cite xref">STD94</a>]</span> format.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">In addition to the CBOR-based data formats for CoSERV queries and responses, this specification also defines API bindings and behaviours for the exchange of CoSERV queries and responses.
This is to facilitate standard interactions between CoSERV producers and consumers.
Standard API endpoints and behaviours will encourage the growth of interoperable software tools and modules, not only for parsing and emitting CoSERV-compliant data, but also for implementing the clients and services that need to exchange such data when acting in the capacity of the relevant RATS roles.
This will be of greater benefit to the software ecosystem than the CoSERV data format alone.
See <a href="#secapibindings" class="auto internal xref">Section 6</a> for the API binding specifications.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="terminology-and-requirements-language">
<section id="section-1.1">
        <h3 id="name-terminology-and-requirement">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology-and-requirement" class="section-name selfRef">Terminology and Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This document uses terms and concepts defined by the RATS architecture.
For a complete glossary, see <span><a href="https://rfc-editor.org/rfc/rfc9334#section-4" class="relref">Section 4</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">This document uses terms and concepts defined by the CoRIM specification.
For a complete glossary, see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-09#section-1.1.1" class="relref">Section 1.1.1</a> of [<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">This document uses the terms <em>"actual state"</em> and <em>"reference state"</em> as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-09#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span>.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">The terminology from CBOR <span>[<a href="#STD94" class="cite xref">STD94</a>]</span>, CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> and COSE <span>[<a href="#STD96" class="cite xref">STD96</a>]</span> applies;
in particular, CBOR diagnostic notation is defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#STD94" class="cite xref">STD94</a>]</span>
and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>. Terms and concepts are always referenced as proper nouns, i.e., with Capital Letters.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="secaggregation">
<section id="section-2">
      <h2 id="name-aggregation-and-trust-model">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-aggregation-and-trust-model" class="section-name selfRef">Aggregation and Trust Models</a>
      </h2>
<p id="section-2-1">The roles of Endorser or Reference Value Provider might sometimes be fulfilled by aggregators, which collect from multiple supply chain sources, or even from other aggregators, in order to project a holistic view of the endorsed system.
The notion of such an aggregator is not explicit in the RATS architecture.
In practice, however, supply chains are complex and multi-layered.
Supply chain sources can include silicon manufacturers, device manufacturers, firmware houses, system integrators, service providers and more.
In practical terms, an Attester is likely to be a complex entity, formed of components from across such supply chains.
Evidence would be likewise structured, with contributions from different segments of the Attester's overall anatomy.
A Verifier for such Evidence may find it convenient to contact an aggregator as a single source of truth for Endorsements and Reference Values.
An aggregator would have intelligence about the Attester's complete anatomy and supply chain.
It would have the ability to contact all contributing supply chain actors for their individual Endorsements and Reference Values, before collecting them into a cohesive set, and delivering them to the Verifier as a single, ergonomic package.
The contributing supply chain actors might themselves be CoSERV-enabled, in which case the aggregator would send one or more separate CoSERV queries to those actors as part of the aggregation process.
Alternatively, it might be necessary to use vendor-specific protocols to gather these artifacts and convert them into the aggregated CoSERV response.
The choice between these approaches is deployment-dependent, and is considered to be an implementation detail of the aggregator.
In pure RATS terms, an aggregator is still an Endorser or a Reference Value Provider - or, more likely, both.
It is not a distinct role, and so there is no distinctly-modeled conveyance between an aggregator and a Verifier.
However, when consuming from an aggregator, the Verifier may need visibility of the aggregation process, possibly to the extent of needing to audit the results by inspecting the individual inputs that came from the original supply chain actors.
CoSERV addresses this need, catering equally for both aggregating and non-aggregating supply chain sources.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">To support deployments with aggregators, CoSERV allows for flexible trust models as follows.<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">
          <p id="section-2-3.1.1"><strong>Shallow Trust</strong>: in this model, the consumer trusts the aggregator, solely and completely, to provide authentic descriptions of the endorsed system.
The consumer does not need to audit the results of the aggregation process.<a href="#section-2-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.2">
          <p id="section-2-3.2.1"><strong>Deep Trust</strong>: in this model, the consumer has a trust relationship with the aggregator, but does not deem this to be sufficient.
The consumer can still use the collected results from the aggregation process, where it is convenient to do so, but also needs to audit those results.<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-4">Any given CoSERV transaction can operate according to either model.
The consumer decides which model to use when it forms a query.
The CoSERV result payload can convey both the aggregated result and the audit trail as needed.
The payload size may be smaller when the shallow model is used, but the choice between the two models is a question for implementations and deployments.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Although CoSERV is designed to support aggregation, it is not a requirement.
When aggregation is not used, CoSERV still fulfills the need for a standard conveyance mechanism between Verifiers and Endorsers or Reference Value Providers.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secinfomodel">
<section id="section-3">
      <h2 id="name-coserv-information-model">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-coserv-information-model" class="section-name selfRef">CoSERV Information Model</a>
      </h2>
<div id="overview">
<section id="section-3.1">
        <h3 id="name-overview">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-3.1-1">CoSERV is designed to facilitate query-response transactions between a producer and a consumer.
In the RATS model, the producer is either an Endorser or a Reference Value Provider, and the consumer is a Verifier.
CoSERV defines a single top-level data type that can be used for both queries and result sets.
Queries are authored by the consumer (Verifier), while result sets are authored by the producer (Endorser or Reference Value Provider) in response to the query.
A CoSERV data object always contains a query.
When CoSERV is used to express a result set, the query is retained alongside the result set that was yielded by that query.
This allows consumers to verify a match between the query that was sent to the producer, and the query that was subsequently returned with the result set.
Such verification is useful because it mitigates security threats arising from any untrusted infrastructure or intermediaries that might reside between the producer and the consumer.
An example of this is caching in HTTP <span>[<a href="#STD98" class="cite xref">STD98</a>]</span> and CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.
It might be expensive to compute the result set for a query, which would make caching desirable.
However, if caching is managed by an untrusted intermediary, then there is a risk that such an untrusted intermediary might return incorrect results, either accidentally or maliciously.
Pairing the original query with each result set provides an end-to-end contract between the consumer and producer, mitigating such risks.
The transactional pattern between the producer and the consumer would be that the consumer begins the transaction by authoring a query and sending it to the producer as a CoSERV object.
The producer receives the query, computes results, and returns a new CoSERV object formed from the results along with the original query.
Notionally, the producer is "adding" the results to the query before sending it back to the consumer.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secartifacts">
<section id="section-3.2">
        <h3 id="name-artifacts">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-artifacts" class="section-name selfRef">Artifacts</a>
        </h3>
<p id="section-3.2-1">Artifacts are what the consumer (Verifier) needs in order to verify and appraise Evidence from the Attester, and therefore they form the bulk of the response payload in a CoSERV transaction.
The common CoSERV query language recognises three artifact types.
These correspond to the three categories of endorsement artifact that can be identified natively in the RATS architecture:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1"><strong>Trust Anchor</strong>: A trust anchor is as defined in <span>[<a href="#RFC6024" class="cite xref">RFC6024</a>]</span>.
An example of a trust anchor would be the public part of the asymmetric signing key that is used by the Attester to sign Evidence, such that the Verifier can verify the cryptographic signature.
This is just one example.
Other forms of trust anchor are possible.
CoSERV does not place any additional requirements or constraints on the conveyance or use of trust anchors, beyond what is already described in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and <span>[<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span>.
<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-09#section-4" class="relref">Section 4</a> of [<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span> sets out the applicable patterns for the endorsement of verification keys, all of which apply equally here.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1"><strong>Endorsed Value</strong>: An endorsed value is as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-09#section-1.1.1" class="relref">Section 1.1.1</a> of [<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>.
This represents a characteristic of the Attester that is not directly presented in the Evidence, such as certification data related to a hardware or firmware module.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.3">
            <p id="section-3.2-2.3.1"><strong>Reference Value</strong>: A reference value is as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-09#section-1.1.1" class="relref">Section 1.1.1</a> of [<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>.
A reference value specifies an individual aspect of the Attester's desired state.
Reference values are sometimes informally called "golden values".
An example of a reference value would be the expected hash or checksum of a binary firmware or software image running in the Attester's environment.
Evidence from the Attester would then include claims about the Attester's actual state, which the Verifier can then compare with the reference values at Evidence appraisal time.<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-3">When artifacts are produced by an aggregator (see <a href="#secaggregation" class="auto internal xref">Section 2</a>), the following additional classifications apply:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1"><strong>Collected Artifacts</strong>: these refer to artifacts that were derived by the aggregator by collecting and presenting data from original supply chain sources, or from other aggregators.
Collected artifacts form a single holistic package, and provide the most ergonomic consumption experience for the Verifier.<a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-4.2">
            <p id="section-3.2-4.2.1"><strong>Source Arfifacts</strong>: these refer to artifacts that were obtained directly from the original supply chain sources, and used as inputs into the aggregation process, allowing the aggregator to derive the collected artifacts.<a href="#section-3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-5">In the shallow trust model of aggregation, only the collected artifacts are used by the consumer.
In the deep trust model, both the collected artifacts and the source artifacts are used.
The source artifacts allow the consumer to audit the collected artifacts and operate the trust-but-verify principle.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secenvironments">
<section id="section-3.3">
        <h3 id="name-environments">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-environments" class="section-name selfRef">Environments</a>
        </h3>
<p id="section-3.3-1">The environment defines the scope (or scopes) in which the endorsement artifacts are applicable.
Given that the consumer of these artifacts is likely to be a Verifier in the RATS model, the typical interpretation of the environment would be that of an Attester that either has produced evidence, or is expected to produce evidence, that the Verifier needs to appraise.
The Verifier consequently needs to query the Endorser or Reference Value Provider for artifacts that are applicable in that environment.
There are three mutually-exclusive methods for defining the environment within a CoSERV query.
Exactly one of these three methods <span class="bcp14">MUST</span> be used for the query to be valid.
All three methods correspond to environments that are also defined within CoRIM <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">
            <p id="section-3.3-2.1.1"><strong>Class</strong>: A class is an environment that is expected to be common to a group of similarly-constructed Attesters, who might therefore share the same set of endorsed characteristics.
An example of this might be a fleet of computing devices of the same model and manufacturer.<a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.2">
            <p id="section-3.3-2.2.1"><strong>Instance</strong>: An instance is an environment that is unique to an individual and identifiable Attester, such as a single computing device or component.<a href="#section-3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.3">
            <p id="section-3.3-2.3.1"><strong>Group</strong>: A group is a collection of common Attester instances that are collected together based on some defined semantics.
For example, Attesters may be put into groups for the purpose of anonymity.<a href="#section-3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="secstateful">
<section id="section-3.3.1">
          <h4 id="name-stateful-environments">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-stateful-environments" class="section-name selfRef">Stateful Environments</a>
          </h4>
<p id="section-3.3.1-1">In addition to specifying the Attester environment by class, instance, or group, it is sometimes necessary to constrain the target environment further by specifying aspects of its state.
This is because the applicability of Endorsements and Reference Values might vary, depending on these stateful properties.
Consider, for example, an Attester instance who signs Evidence using a derived attestation key, where the derivation algorithm is dependent on one or more aspects of the Attester's current state, such as the version number of an upgradable firmware component.
This example Attester would, at different points in its lifecycle, sign Evidence with different attestation keys, since the keys would change upon any firmware update.
To provide the correct public key to use as the trust anchor for verification, the Endorser would need to know the configured state of the Attester at the time the Evidence was produced.
Specifying such an Attester solely by its instance identifier is therefore insufficient for the Endorser to supply the correct artifact.
The environment specification would need to include these critical stateful aspects as well.
In CoRIM <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>, stateful environments are modeled as an environment identifier plus a collection of measurements, and CoSERV takes the same approach.
Therefore, any environment selector in a CoSERV query can optionally be enhanced with a collection of one or more measurements, which specify aspects of the target environment state that might materially impact the selection of artifacts.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="queries">
<section id="section-3.4">
        <h3 id="name-queries">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-queries" class="section-name selfRef">Queries</a>
        </h3>
<p id="section-3.4-1">The purpose of a query is to allow the consumer (Verifier) to specify the artifacts that it needs.
The information that is conveyed in a CoSERV query includes the following:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">A specification of the required artifact type: Reference Value, Endorsed Value or Trust Anchor.
See <a href="#secartifacts" class="auto internal xref">Section 3.2</a> for definitions of artifact types.
A single CoSERV query can only specify a single artifact type.<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">A specification of the Attester's environment.
Environments can be selected according to Attester instance, group or class.
Additional properties of the environment state can be specified by adding one or more measurements to the selector.
See <a href="#secenvironments" class="auto internal xref">Section 3.3</a> for full definitions.
To facilitate efficient transactions, a single query can specify either multiple instances, multiple groups or multiple classes.
However, it is not possible to mix instance-based selectors, group-based selectors and class-based selectors in a single query.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.3">
            <p id="section-3.4-2.3.1">A switch to select the desired supply chain depth.
A CoSERV query can request collected artifacts, source artifacts, or both.
This switch is especially relevant when the CoSERV query is fulfilled by an aggregator.
The collected artifacts are intended for convenient consumption (according to the shallow trust model), while the source artifacts are principally useful for auditing (according to the deep trust model).
It is possible for a query to select for source artifacts only, without the collected artifacts.
This might happen when the consumer needs to inspect or audit artifacts from across the deep supply chain, while not requiring the convenience of the aggregated view.
It could also happen when the consumer is acting as an intermediate broker, gathering artifacts for delivery to another aggregator.
See <a href="#secaggregation" class="auto internal xref">Section 2</a> for details on aggregation, auditing and trust models.<a href="#section-3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-3">CoSERV queries do not contain timestamps or any similarly volatile or unpredictable fields.
This is to ensure that any set of materially-identical queries will always yield the same encoded sequence of CBOR bytes, regardless of the time when they were issued, or of other volatile factors.
Along with the other encoding rules set out in <a href="#secencoding" class="auto internal xref">Section 4.5</a>, it means that a query can be used as a stable and canonical identifier of artifacts.
This property of queries is an important enabler of efficient CoSERV transactions.
See, for example, the HTTP caching design described in <a href="#secrrapicaching" class="auto internal xref">Section 6.1.3</a>.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">A CoSERV implementation <span class="bcp14">MAY</span> log the time at which a query was received and fulfilled.
This might sometimes be desirable for transparency or audit purposes.
Implementations are free to define their own transparency events, which can then include timestamps or other suitable information.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="result-sets">
<section id="section-3.5">
        <h3 id="name-result-sets">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-result-sets" class="section-name selfRef">Result Sets</a>
        </h3>
<p id="section-3.5-1">The result set contains the artifacts that the producer collected in response to the query.
The top-level structure of the result set consists of the following three items:<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-2.1">
            <p id="section-3.5-2.1.1">A collection of one or more result entries.
This will be a collection of either reference values, endorsed values or trust anchors.
See <a href="#secartifacts" class="auto internal xref">Section 3.2</a> for definitions of artifact types.
Artifact types are never mixed in any single CoSERV result set.
The artifacts in the result collection therefore <span class="bcp14">MUST</span> match the single artifact type specified in the original CoSERV query.<a href="#section-3.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.2">
            <p id="section-3.5-2.2.1">A timestamp indicating the expiry time of the entire result set.
Consumers <span class="bcp14">MUST NOT</span> consider any part of the result set to be valid after this expiry time.<a href="#section-3.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.3">
            <p id="section-3.5-2.3.1">A collection of the original source materials from which the producer derived the correct artifacts to include in the result set.
These source materials are optional, and their intended purpose is auditing.
They are included only when requested by the original CoSERV query.
Source materials would typically be requested in cases where the consumer is not willing to place sole trust in the producer, and therefore needs an audit trail to enable additional verifications.<a href="#section-3.5-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.5-3">Each individual result entry combines a CoMID triple with an authority delegation chain.
CoMID triples are exactly as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-09#section-5.1.4" class="relref">Section 5.1.4</a> of [<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>.
Each CoMID triple will demonstrate the association between an environment matching that of the CoSERV query, and a single artifact such as a reference value, trust anchor or endorsed value.
The authority delegation chain is composed of one or more authority delegates.
Each authority delegate is represented by a public key or key identifier, which the consumer can check against its own set of trusted authorities.
The authority delegation chain serves to establish the provenance of the result entry, and enables the Verifier to evaluate the trustworthiness of the associated artifact.
The purpose of the authority delegation chain is to allow CoSERV responses to support decentralized trust models, where Verifiers may apply their own policy to determine which authorities are acceptable for different classes of artifact.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">Because each result entry combines a CoMID triple with an authority delegation chain, the entries are consequently known as quadruples (or "quads" for short).<a href="#section-3.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="secdatamodel">
<section id="section-4">
      <h2 id="name-coserv-data-model">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-coserv-data-model" class="section-name selfRef">CoSERV Data Model</a>
      </h2>
<p id="section-4-1">This section specifies the CBOR data model for CoSERV queries and result sets.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">CDDL is used to express rules and constraints of the data model for CBOR.
These rules must be strictly followed when creating or validating CoSERV data objects.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The top-level CoSERV data structure is given by the following CDDL:<a href="#section-4-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4-4">
<pre>
;# import comid-autogen

coserv = {
  &amp;(profile: 0) =&gt; profile
  &amp;(query: 1) =&gt; query
  ? &amp;(results: 2) =&gt; results
}

profile = comid.oid-type / ~uri
</pre><a href="#section-4-4" class="pilcrow">¶</a>
</div>
<div id="common-data-types">
<section id="section-4.1">
        <h3 id="name-common-data-types">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-common-data-types" class="section-name selfRef">Common Data Types</a>
        </h3>
<p id="section-4.1-1">CoSERV inherits the following types from the CoRIM data model <code>class-map</code>, <code>$class-id-type-choice</code>, <code>$instance-id-type-choice</code> and <code>$group-id-type-choice</code>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The collated CDDL is in <a href="#collated-cddl-coserv" class="auto internal xref">Appendix A.1</a>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="profile">
<section id="section-4.2">
        <h3 id="name-profile">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-profile" class="section-name selfRef">Profile</a>
        </h3>
<p id="section-4.2-1">In common with EAT and CoRIM, CoSERV supports the notion of profiles.
As with EAT and CoRIM, profiles are a way to extend or specialize the structure of a generic CoSERV query in order to cater for a specific use case or environment.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">In a CoSERV query, the profile can be identified by either a Uniform Resource Identifier (URI) or an Object Identifier (OID).
This convention is identical to how EAT profiles are identified using the <code>eat_profile</code> claim as described in <span><a href="https://rfc-editor.org/rfc/rfc9711#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="query-structure">
<section id="section-4.3">
        <h3 id="name-query-structure">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-query-structure" class="section-name selfRef">Query Structure</a>
        </h3>
<p id="section-4.3-1">The CoSERV query language enables Verifiers to specify the desired characteristics of Endorsements and Reference Values based on the environment in which they are applicable.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The top-level structure of a CoSERV query is given by the following CDDL:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.3-3">
<pre>
query = {
  &amp;(artifact-type: 0) =&gt; artifact-type
  &amp;(environment-selector: 1) =&gt; environment-selector-map
  &amp;(result-type: 2) =&gt; result-type
}

artifact-type = &amp;(endorsed-values: 0)
                / &amp;(trust-anchors: 1)
                / &amp;(reference-values: 2)

result-type = &amp;(collected-artifacts: 0)
              / &amp;(source-artifacts: 1)
              / &amp;(both: 2)
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3-4">The meanings of these fields are detailed in the following subsections.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div id="artifact-type">
<section id="section-4.3.1">
          <h4 id="name-artifact-type">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-artifact-type" class="section-name selfRef">Artifact Type</a>
          </h4>
<p id="section-4.3.1-1">The <code>artifact-type</code> field is the foremost discriminator of the query.
It is a top-level category selector. Its three permissible values are <code>trust-anchors</code> (codepoint 1), <code>endorsed-values</code> (codepoint 0) and <code>reference-values</code> (codepoint 2).<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">See <a href="#secartifacts" class="auto internal xref">Section 3.2</a> for full definitions of artifact types.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3">It is expected that implementations might choose to store these different categories of artifacts in different top-level stores or database tables.
Where this is the case, the <code>artifact-type</code> field serves to narrow the query down to the correct store or table.
Even where this is not the case, the discriminator is useful as a filter for the consumer, resulting in an efficiency gain by avoiding the transfer of unwanted data items.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="environment-selector">
<section id="section-4.3.2">
          <h4 id="name-environment-selector">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-environment-selector" class="section-name selfRef">Environment Selector</a>
          </h4>
<p id="section-4.3.2-1">The environment selector forms the main body of the query, and its CDDL is given below:<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.3.2-2">
<pre>
;# import comid-autogen

environment-selector-map = { selector }

stateful-class = [
  class: comid.class-map
  ? measurements: [ + comid.measurement-map ]
]

selector //= ( &amp;(class: 0) =&gt; [
  + stateful-class
] )

stateful-instance = [
  instance: comid.$instance-id-type-choice
  ? measurements: [ + comid.measurement-map ]
]

selector //= ( &amp;(instance: 1) =&gt; [
  + stateful-instance
] )

stateful-group = [
  group: comid.$group-id-type-choice
  ? measurements: [ + comid.measurement-map ]
]

selector //= ( &amp;(group: 2) =&gt; [
  + stateful-group
] )
</pre><a href="#section-4.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-3">Environments can be specified according to instance, group or class. See <a href="#secenvironments" class="auto internal xref">Section 3.3</a> for details.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.2-4">Although these three environment definitions are mutually-exclusive in a CoSERV query, all three support multiple entries.
This is to gain efficiency by allowing the consumer (Verifier) to query for multiple artifacts in a single transaction.
For example, where artifacts are being indexed by instance, it would be possible to specify an arbitrary number of instances in a single query, and therefore obtain the artifacts for all of them in a single transaction.
Likewise for classes and groups.
However, it would not be possible for a single query to specify more than one kind of environment.
For example, it would not be possible to query for both class-level and instance-level artifacts in a single CoSERV transaction.<a href="#section-4.3.2-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2-5">All three environment selector types can optionally be enhanced with one or more <code>measurement-map</code> entries, which are used to express aspects of the environment state.
See <a href="#secstateful" class="auto internal xref">Section 3.3.1</a> for a description of stateful environments.<a href="#section-4.3.2-5" class="pilcrow">¶</a></p>
<div id="selector-semantics">
<section id="section-4.3.2.1">
            <h5 id="name-selector-semantics">
<a href="#section-4.3.2.1" class="section-number selfRef">4.3.2.1. </a><a href="#name-selector-semantics" class="section-name selfRef">Selector Semantics</a>
            </h5>
<p id="section-4.3.2.1-1">When multiple environment selectors are present in a single query, such as multiple instances or multiple groups, the recipient of the query <span class="bcp14">MUST</span> consider these to be alternatives, and hence use a logical <code>OR</code> operation when applying the query to its internal data stores.<a href="#section-4.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.1-2">Below is an illustrative example of how a CoSERV query for endorsed values, selecting for multiple Attester instances, might be transformed into a semantically-equivalent SQL database query:<a href="#section-4.3.2.1-2" class="pilcrow">¶</a></p>
<div class="lang-sql sourcecode" id="section-4.3.2.1-3">
<pre>
SELECT *
  FROM endorsed_values
 WHERE ( instance-id = "At6tvu/erQ==" ) OR
       ( instance-id = "iZl4ZVY=" )`
</pre><a href="#section-4.3.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2.1-4">The same applies for class-based selectors; however, since class selectors are themselves composed of multiple inner fields, the recipient of the query <span class="bcp14">MUST</span> use a logical <code>AND</code> operation in consideration of the inner fields for each class.<a href="#section-4.3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2.1-5">Also, for class-based selectors, any unset fields in the class are assumed to be wildcard (<code>*</code>), and therefore match any value.<a href="#section-4.3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2.1-6">Below is an illustrative example of how a CoSERV query for reference values, selecting for multiple Attester classes, might be transformed into a semantically-equivalent SQL database query:<a href="#section-4.3.2.1-6" class="pilcrow">¶</a></p>
<div class="lang-sql sourcecode" id="section-4.3.2.1-7">
<pre>
SELECT *
  FROM reference_values
 WHERE ( class-id = "iZl4ZVY=" AND class-vendor = "ACME Inc." ) OR
       ( class-id = "31fb5abf-023e-4992-aa4e-95f9c1503bfa" )
</pre><a href="#section-4.3.2.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="result-type">
<section id="section-4.3.3">
          <h4 id="name-result-type">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-result-type" class="section-name selfRef">Result Type</a>
          </h4>
<p id="section-4.3.3-1">The <code>result-type</code> field selects for the desired type(s) of results: <code>collected-artifacts</code> (codepoint 0), <code>source-artifacts</code> (codepoint 1) or <code>both</code> (codepoint 2).
See <a href="#secaggregation" class="auto internal xref">Section 2</a> for definitions of source and collected artifacts.<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="result-set-structure">
<section id="section-4.4">
        <h3 id="name-result-set-structure">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-result-set-structure" class="section-name selfRef">Result Set Structure</a>
        </h3>
<p id="section-4.4-1">The result set structure is given by the following CDDL:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div class="breakable lang-cddl sourcecode" id="section-4.4-2">
<pre>
;# import cmw-autogen
;# import comid-autogen

results = {
  result-set
  &amp;(expiry: 10) =&gt; tdate ; RFC3339 date
  ? &amp;(source-artifacts: 11) =&gt; [ + cmw.cbor-record ]
}

result-set //= reference-values
result-set //= endorsed-values
result-set //= trust-anchors

refval-quad = {
  &amp;(authorities: 1) =&gt; [ + comid.$crypto-key-type-choice ]
  &amp;(rv-triple: 2) =&gt; comid.reference-triple-record
}

reference-values = (
  &amp;(rvq: 0) =&gt; [ * refval-quad ]
)

endval-quad = {
  &amp;(authorities: 1) =&gt; [ + comid.$crypto-key-type-choice ]
  &amp;(ev-triple: 2) =&gt; comid.endorsed-triple-record
}

cond-endval-quad = {
  &amp;(authorities: 1) =&gt; [ + comid.$crypto-key-type-choice ]
  &amp;(ce-triple: 2) =&gt; comid.conditional-endorsement-triple-record
}

endorsed-values = (
  &amp;(evq: 1) =&gt; [ * endval-quad ]
  &amp;(ceq: 2) =&gt; [ * cond-endval-quad ]
)

ak-quad = {
  &amp;(authorities: 1) =&gt; [ + comid.$crypto-key-type-choice ]
  &amp;(ak-triple: 2) =&gt; comid.attest-key-triple-record
}

cots-stmt = {
  &amp;(authorities: 1) =&gt; [ + comid.$crypto-key-type-choice ]
  &amp;(cots: 2) =&gt; cots
}

trust-anchors = (
  &amp;(akq: 3) =&gt; [ * ak-quad ]
  &amp;(tas: 4) =&gt; [ * cots-stmt ]
)

;
; import CoTS
;
cots = "TODO COTS"
</pre><a href="#section-4.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="secencoding">
<section id="section-4.5">
        <h3 id="name-encoding-requirements">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-encoding-requirements" class="section-name selfRef">Encoding Requirements</a>
        </h3>
<p id="section-4.5-1">Implementations may wish to use serialized CoSERV queries as canonical identifiers for artifact collections.
For example, a Reference Value Provider service may wish the cache the results of a CoSERV query to gain efficiency when responding to a future identical query.
For these use cases to be effective, it is essential that any given CoSERV query is always serialized to the same fixed sequence of CBOR bytes.
Therefore, CoSERV queries <span class="bcp14">MUST</span> always use CBOR deterministic encoding as specified in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-4.2" class="relref">Section 4.2</a> of [<a href="#STD94" class="cite xref">STD94</a>]</span>.
Further, CoSERV queries <span class="bcp14">MUST</span> use CBOR definite-length encoding.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signed-coserv">
<section id="section-4.6">
        <h3 id="name-cryptographic-binding-betwe">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-cryptographic-binding-betwe" class="section-name selfRef">Cryptographic Binding Between Query and Result Set</a>
        </h3>
<p id="section-4.6-1">CoSERV is designed to ensure that any result set passed from a producer to a consumer is precisely the result set that corresponds to the consumer's original query.
This is the reason why the original query is always included along with the result set in the data model.
However, this measure is only sufficient in cases where the conveyance protocol guarantees that CoSERV result sets are always transacted over a secure channel without any untrusted intermediaries.
Wherever this is not the case, producers <span class="bcp14">MUST</span> create an additional cryptographic binding between the query and the result.
This is achieved by transacting the result set within a cryptographic envelope, with a signature added by the producer, which is verified by the consumer.
A CoSERV data object can be signed using COSE <span>[<a href="#STD96" class="cite xref">STD96</a>]</span>.
A <code>signed-coserv</code> is a <code>COSE_Sign1</code> with the following layout:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.6-2">
<pre>
signed-coserv = #6.18([
  protected: bytes .cbor signed-coserv-protected-hdr
  unprotected: signed-coserv-unprotected-hdr
  payload: bytes .cbor coserv
  signature: bytes
])
</pre><a href="#section-4.6-2" class="pilcrow">¶</a>
</div>
<p id="section-4.6-3">The payload <span class="bcp14">MUST</span> be the CBOR-encoded CoSERV.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.6-4">
<pre>
signed-coserv-protected-hdr = {
  1 =&gt; int                            ; alg
  2 =&gt; "application/coserv+cbor" / 10000 ; cty
  * cose.label =&gt; cose.values
}

signed-coserv-unprotected-hdr = {
  * cose.label =&gt; cose.values
}

cose.label = int / text
cose.values = any
</pre><a href="#section-4.6-4" class="pilcrow">¶</a>
</div>
<p id="section-4.6-5">The protected header <span class="bcp14">MUST</span> include the signature algorithm identifier.
The protected header <span class="bcp14">MUST</span> include either the content type <code>application/coserv+cbor</code> or the CoAP Content-Format TBD1.
Other header parameters <span class="bcp14">MAY</span> be added to the header buckets, for example a <code>kid</code> that identifies the signing key.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-5">
      <h2 id="name-examples">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="query-data-examples">
<section id="section-5.1">
        <h3 id="name-query-data-examples">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-query-data-examples" class="section-name selfRef">Query Data Examples</a>
        </h3>
<p id="section-5.1-1">This section provides some illustrative examples of valid CoSERV query objects.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The following example shows a query for Reference Values scoped by a single class.
The <code>artifact-type</code> is set to 2 (<code>reference-values</code>), indicating a query for Reference Values.
The <code>profile</code> is given the example value of <code>tag:example.com,2025:cc-platform#1.0.0</code>.
Finally, the <code>environment-selector</code> uses the key 0 to select for class, and the value contains a single entry with illustrative settings for the identifier, vendor and model.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-5.1-3">
<pre>
{
  / profile / 0: "tag:example.com,2025:cc-platform#1.0.0",
  / query /   1: {
    / artifact-type /         0: 2, / reference-values /
    / environment-selector /  1: {
      / class / 0: [ [
        {
          / class-id /  0: 560(h'00112233'),  / tagged-bytes /
          / vendor /    1: "Example Vendor",
          / model /     2: "Example Model"
        }
      ] ]
    },
    / result-type / 2: 1 / source-artifacts /
  }
}
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">The next example is similar, but adds a second entry to the set of classes in the <code>environment-map</code>, showing how multiple classes can be queried at the same time.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-5.1-5">
<pre>
{
  / profile / 0: "tag:example.com,2025:cc-platform#1.0.0",
  / query /   1: {
    / artifact-type /         0: 2, / reference-values /
    / environment-selector /  1: {
      / class / 0: [
        [ {
          / class-id /  0: 560(h'8999786556'),  / tagged-bytes /
          / vendor /    1: "Example Vendor",
          / model /     2: "Example Model"
        } ],
        [ {
          / class-id /  0:
            37(h'31FB5ABF023E4992AA4E95F9C1503BFA')  / UUID /
        } ]
      ]
    },
    / result-type / 2: 2 / both collected and source artifacts /
  }
}
</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1-6">The following example shows a query for Reference Values scoped by instance.
Again, the <code>artifact-type</code> is set to 2, and <code>profile</code> is given a demonstration value. The <code>environment-selector</code> now uses the key 1 to select for instances, and the value contains two entries with example instance identifiers.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-5.1-7">
<pre>
{
  / profile / 0: "tag:example.com,2025:cc-platform#1.0.0",
  / query /   1: {
    / artifact-type / 0: 2, / reference-values /
    / environment-selector /  1: {
      / instance / 1: [
        [ 550(h'02DEADBEEFDEAD') ], / UEID /
        [ 560(h'8999786556') ]      / tagged-bytes /
      ]
    },
    / result-type / 2: 0 / collected artifacts /
  }
}
</pre><a href="#section-5.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="result-data-examples">
<section id="section-5.2">
        <h3 id="name-result-data-examples">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-result-data-examples" class="section-name selfRef">Result Data Examples</a>
        </h3>
<p id="section-5.2-1">This section provides some illustrative examples of valid CoSERV queries with their corresponding result sets.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">In this next example, the query is a reference value query based on class.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The top-level structure is a map with three entries: <code>profile</code> (codepoint 0), <code>query</code> (codepoint 1) and <code>results</code> (codepoint 2).<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The profile and query structures are the same as in the previous examples.
The result structure is a map with two entries: <code>expiry</code> (codepoint 10) and <code>rvq</code> (codepoint 0).
The <code>rvq</code> (reference value quad) entry comprises the asserting authority and the asserted triples.
A single reference-value triple is shown in this example.
Its <code>environment-map</code>, as expected, is the same as the <code>environment-map</code> that was supplied in the query.
The rest of the structure is the <code>measurement-map</code> as defined in CoRIM <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-5.2-5">
<pre>
{
  / profile / 0: "tag:example.com,2025:cc-platform#1.0.0",
  / query / 1: {
    0: 2,
    1: {
      0: [ [
        {
          0: 560(h'8999786556')
        }
      ] ]
    },
    2: 0
  },
  / results / 2: {
    0: [
      {
        1: [ 560(h'abcdef') ],
        2: [
          {
            0: {
              0: 560(h'8999786556')
            }
          },
          [
            {
              0: 37(h'31FB5ABF023E4992AA4E95F9C1503BFA'),
              1: {
                / version / 0: {
                  0: "1.2.3",
                  1: 16384
                },
                / svn / 1: 553(2)
              }
            }
          ]
        ]
      }
    ],
    10: 0("2030-12-13T18:30:02Z")
  }
}
</pre><a href="#section-5.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.2-6">The following example is for a query that requested the results be provided in the "source artifacts" format.
This means one or more original signed manifests containing information that satisfies the query criteria.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">Compared with the previous example, the <code>rvq</code> entry is empty, while the <code>source-artifacts</code> (codepoint 11) contain two CMW records <span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span>, each of which contains a (made up) manifest with the type "application/vnd.example.refvals".<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-5.2-8">
<pre>
{
  / profile / 0: "tag:example.com,2025:cc-platform#1.0.0",
  / query /   1: {
    / artifact-type /         0: 2, / reference-values /
    / environment-selector /  1: {
      / class / 0: [ [
        {
          / class-id /  0: 560(h'00112233'),  / tagged-bytes /
          / vendor /    1: "Example Vendor",
          / model /     2: "Example Model"
        }
      ] ]
    },
    / result-type / 2: 1 / source-artifacts /
  },
  / results / 2: {
    / rvq / 0: [ ],
    / expiry / 10: 0("2030-12-13T18:30:02Z"),
    / source artifacts / 11: [
      [ "application/vnd.example.refvals", h'afaeadac' ],
      [ "application/vnd.example.refvals", h'adacabaa' ]
    ]
  }
}
</pre><a href="#section-5.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="secapibindings">
<section id="section-6">
      <h2 id="name-api-bindings">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-api-bindings" class="section-name selfRef">API Bindings</a>
      </h2>
<p id="section-6-1">This section sets out the ways in which CoSERV queries and responses can be exchanged between software components and services using APIs.
The CoSERV data format itself is agnostic of any particular API model or transport.
The API bindings provided here are intended to complement the data format.
They will allow implementations to build the complete functionality of a CoSERV producer or consumer, in a way that is well-suited to any transport or interaction model that is needed.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">It is intended that these API definitions carry minimal additional semantics, since these are largely the preserve of the CoSERV query language itself.
The API definitions are merely vehicles for the exchange of CoSERV queries and responses.
Their purpose is to facilitate standard interactions that make the most effective use of available transports and protocols.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The only API binding that is specified in this document is a request-response protocol that uses HTTP for transport.
This is a simple pattern, and likely to be a commonly occurring one for a variety of use cases.
Future specifications may define other API bindings.
Such future bindings may introduce further HTTP-based protocols.
Alternatively, they may define protocols for use with other transports, such as CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="secrrapi">
<section id="section-6.1">
        <h3 id="name-request-response-over-http">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-request-response-over-http" class="section-name selfRef">Request Response over HTTP</a>
        </h3>
<p id="section-6.1-1">This section defines and mandates the API endpoint behaviours for CoSERV request-response transactions over HTTP.
Implementations <span class="bcp14">MUST</span> provide all parts of the API as specified in this section.
The API is a simple protocol for the execution of CoSERV queries.
It takes a single CoSERV query as input, and produces a corresponding single CoSERV result set as the output.
It is a RESTful API because the CoSERV query serves as a unique and stable identifier of the target resource, where that resource is the set of artifacts being selected for by the query.
The encoding rules for CoSERV are deterministic as set out in <a href="#secencoding" class="auto internal xref">Section 4.5</a>.
This means that any given CoSERV query will always encode to the same sequence of bytes.
The Base64Url encoding (<span><a href="https://rfc-editor.org/rfc/rfc7515#section-2" class="relref">Section 2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>) of the byte sequence becomes the rightmost path segment of the URI used to identify the target resource.
The HTTP <code>GET</code> verb is then used with this URI to execute the query.
Further details are provided in the subsections below.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Authentication is out of scope for this document.
Implementations <span class="bcp14">MAY</span> authenticate clients, for example for authorization or for preventing denial of service attacks.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<div id="secrrapidisco">
<section id="section-6.1.1">
          <h4 id="name-discovery">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-discovery" class="section-name selfRef">Discovery</a>
          </h4>
<p id="section-6.1.1-1">Clients discover CoSERV HTTP API endpoints by means of a well-known URI that is formed using the <code>/.well-known/</code> path prefix as defined in <span>[<a href="#RFC8615" class="cite xref">RFC8615</a>]</span>.
This URI supplies a single discovery document that clients can use to locate the URIs of other API endpoints, in addition to finding out other relevant information about the configuration and capabilities of the service.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">Implementations that provide CoSERV HTTP API endpoints <span class="bcp14">MUST</span> also provide the discovery endpoint at the path <code>/.well-known/coserv-configuration</code>.
This endpoint <span class="bcp14">MUST</span> be available via an HTTP GET method with no additional query parameters.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">The response body can be formatted using either JSON or CBOR, governed by standard HTTP content-type negotiation.
The media types defined for this purpose are <code>application/coserv-discovery+json</code> (for JSON-formatted documents) or <code>application/coserv-discovery+cbor</code> (for CBOR-formatted documents).
If the client presents any media type other than these two options in its HTTP <code>Accept</code> header, the implementation <span class="bcp14">SHOULD</span> respond with an HTTP 406 (Not Acceptable) status code.
If the client presents one of the two valid media types, then the implementation <span class="bcp14">MUST</span> respond with an HTTP 200 (OK) status code, unless it is prevented from doing so by an error condition beyond the scope of this specification.
When the 200 (OK) status code is returned, the response body <span class="bcp14">MUST</span> contain exactly one discovery document in the requested format (JSON or CBOR).
The contents of the discovery document <span class="bcp14">MUST</span> conform to the CDDL data model given below, which is common to both the JSON and CBOR encodings.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-6.1.1-4">
<pre>
;# import rfc9711 as eat
;# import cmw-autogen as cmw
;# import rfc9052 as cose
;# import jwk-autogen as jwk

coserv-well-known-info = {
  version-label =&gt; version,
  capabilities-label =&gt; [ + capability ],
  api-endpoints-label =&gt; { + tstr =&gt; tstr },
  ? result-verification-key-label =&gt; eat.JC&lt;jwk.JWK_Set, cose.COSE_KeySet&gt;
}

version-label = eat.JC&lt;"version", 1&gt;
capabilities-label = eat.JC&lt;"capabilities", 2&gt;
api-endpoints-label = eat.JC&lt;"api-endpoints", 3&gt;
result-verification-key-label = eat.JC&lt;"result-verification-key", 4&gt;

version = tstr

capability = {
  media-type-label =&gt; cmw.media-type,
  artifact-support-label =&gt; artifact-support
}

media-type-label = eat.JC&lt;"media-type", 1&gt;
artifact-support-label = eat.JC&lt;"artifact-support", 2&gt;

non-empty-array&lt;M&gt; = (M) .and ([ + any ])
artifact-support = non-empty-array&lt;[ ? "source", ? "collected" ]&gt;
</pre><a href="#section-6.1.1-4" class="pilcrow">¶</a>
</div>
<div id="discovery-document-contents">
<section id="section-6.1.1.1">
            <h5 id="name-discovery-document-contents">
<a href="#section-6.1.1.1" class="section-number selfRef">6.1.1.1. </a><a href="#name-discovery-document-contents" class="section-name selfRef">Discovery Document Contents</a>
            </h5>
<p id="section-6.1.1.1-1">This section defines how to populate and interpret the data fields in the discovery document.<a href="#section-6.1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1.1-2">The collated CDDL is in <a href="#collated-cddl-discovery" class="auto internal xref">Appendix A.2</a>.<a href="#section-6.1.1.1-2" class="pilcrow">¶</a></p>
<div id="version">
<section id="section-6.1.1.1.1">
              <h6 id="name-version">
<a href="#section-6.1.1.1.1" class="section-number selfRef">6.1.1.1.1. </a><a href="#name-version" class="section-name selfRef">Version</a>
              </h6>
<p id="section-6.1.1.1.1-1">The version field is denoted by the label <code>"version"</code> in JSON documents and by the codepoint <code>1</code> in CBOR documents.
It is a Semantic Versioning (semver) string, which denotes the version and patch level of the service that is providing the API endpoints described by the document.
The semver string <span class="bcp14">MUST</span> conform to the ABNF defined in <span>[<a href="#SEMVER" class="cite xref">SEMVER</a>]</span>.
Version numbers and patch levels are otherwise implementation-defined.<a href="#section-6.1.1.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="capabilities">
<section id="section-6.1.1.1.2">
              <h6 id="name-capabilities">
<a href="#section-6.1.1.1.2" class="section-number selfRef">6.1.1.1.2. </a><a href="#name-capabilities" class="section-name selfRef">Capabilities</a>
              </h6>
<p id="section-6.1.1.1.2-1">The capabilities field is denoted by the label <code>"capabilities"</code> in JSON documents and by the codepoint <code>2</code> in CBOR documents.
This field allows clients to discover the profiled variants of CoSERV for which the service implementation can satisfy queries and provide artifacts.
This field is structured as an array, which allows for service implementations that support more than one profile.
Each supported profile is indicated according to its parameterized media type, along with the categories of artifact that can be provided for the profile.
The artifact categories are <code>source</code> and <code>collected</code>, as described in <a href="#secartifacts" class="auto internal xref">Section 3.2</a>.
Each profile is paired with a non-empty set of artifact categories, allowing the service implementation to indicate whether it supports the retrieval of source artifacts, collected artifacts, or both.
This pairing caters for situations where the service implementation might support different combinations of artifact category for different profiles.<a href="#section-6.1.1.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="api-endpoints">
<section id="section-6.1.1.1.3">
              <h6 id="name-api-endpoints">
<a href="#section-6.1.1.1.3" class="section-number selfRef">6.1.1.1.3. </a><a href="#name-api-endpoints" class="section-name selfRef">API Endpoints</a>
              </h6>
<p id="section-6.1.1.1.3-1">The API endpoints field is denoted by the label <code>"api-endpoints"</code> in JSON documents and by the codepoint <code>3</code> in CBOR documents.
This field allows clients to derive the correct URL for making HTTP API calls.
The field is a map whose keys are the symbolic names of the APIs, and whose values are the URL path for the API endpoint.<a href="#section-6.1.1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1.1.3-2">The symbolic name <code>CoSERVRequestResponse</code> is defined for services that offer the transactional API described in <a href="#secrrapiquery" class="auto internal xref">Section 6.1.2</a>.
Service implementations that offer this API <span class="bcp14">MUST</span> include a key with this name in the endpoints map field, and the corresponding endpoint URL path <span class="bcp14">MUST</span> end with <code>/{query}</code>.
This allows the consumer to form a valid CoSERV query URI using variable expansion as per <span>[<a href="#RFC6570" class="cite xref">RFC6570</a>]</span>, replacing the <code>{query}</code> variable with the Base64Url-encoded CoSERV query object.
There <span class="bcp14">MUST NOT</span> be any other variables that require substitution.<a href="#section-6.1.1.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="result-verification-key">
<section id="section-6.1.1.1.4">
              <h6 id="name-result-verification-key">
<a href="#section-6.1.1.1.4" class="section-number selfRef">6.1.1.1.4. </a><a href="#name-result-verification-key" class="section-name selfRef">Result Verification Key</a>
              </h6>
<p id="section-6.1.1.1.4-1">The result verification key is denoted by the label <code>"result-verification-key"</code> in JSON documents and by the codepoint <code>4</code> in CBOR documents.
This field provides one or more public keys that can be used for the cryptographic verification of CoSERV query results that are returned by the service implementation.
In JSON-formatted discovery documents, each key is a JSON Web Key (JWK) as defined in <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.
In CBOR-formatted discovery documents, each key is a COSE Key as defined in <span>[<a href="#STD96" class="cite xref">STD96</a>]</span>.<a href="#section-6.1.1.1.4-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1.1.4-2">This field is optional.
As described in <a href="#signed-coserv" class="auto internal xref">Section 4.6</a>, there are situations where it is permissible for CoSERV result sets to be unsigned, namely when they are transacted over an end-to-end secure channel without any untrusted intermediaries.
CoSERV service implementations <span class="bcp14">MAY</span> publish discovery documents without result-verification keys in cases where they exclusively produce unsigned CoSERV result sets.
Unsigned CoSERV result sets are characterized by use of the <code>application/coserv+cbor</code> media type (as opposed to the <code>application/coserv+cose</code> media type).
The supported media types, along with their profile parameters, are published in the <code>capabilities</code> field of the discovery document.
If all supported media types are variants of <code>application/coserv+cbor</code>, indicating unsigned results only, then there is no need for the verification key set to be included in the discovery document.
If one or more of the supported media types are variants of <code>application/coserv+cose</code>, indicating signed results, then the verification key set <span class="bcp14">MUST</span> be included.<a href="#section-6.1.1.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="discovery-document-cbor-encoding">
<section id="section-6.1.1.2">
            <h5 id="name-discovery-document-cbor-enc">
<a href="#section-6.1.1.2" class="section-number selfRef">6.1.1.2. </a><a href="#name-discovery-document-cbor-enc" class="section-name selfRef">Discovery Document CBOR Encoding</a>
            </h5>
<p id="section-6.1.1.2-1">When the discovery document is encoded as CBOR, it is exempt from the encoding rules specified in <a href="#secencoding" class="auto internal xref">Section 4.5</a>.
These encoding rules are designed to ensure that CoSERV queries can be used as canonical and stable identifiers.
The discovery document is an independent structure, and not part of the CoSERV data model itself.
Therefore, these encoding rules do not apply.<a href="#section-6.1.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discovery-document-examples">
<section id="section-6.1.1.3">
            <h5 id="name-discovery-document-examples">
<a href="#section-6.1.1.3" class="section-number selfRef">6.1.1.3. </a><a href="#name-discovery-document-examples" class="section-name selfRef">Discovery Document Examples</a>
            </h5>
<p id="section-6.1.1.3-1">In the following examples, the contents of bodies are informative examples only.<a href="#section-6.1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1.3-2">Example HTTP request for retrieving the discovery document in JSON format:<a href="#section-6.1.1.3-2" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.1.3-3">
<pre>
GET /.well-known/coserv-configuration HTTP/1.1
Host: endorsements-distributor.example
Accept: application/coserv-discovery+json
</pre><a href="#section-6.1.1.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1.3-4">Corresponding HTTP response:<a href="#section-6.1.1.3-4" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.1.3-5">
<pre>
HTTP/1.1 200 OK
Content-Type: application/coserv-discovery+json

Body (JSON)

=============== NOTE: '\' line wrapping per RFC 8792 ================

{
  "version": "1.2.3-beta",
  "capabilities": [
    {
      "media-type": "application/coserv+cose; profile=\"tag:vendor.\
                                       com,2025:cc_platform#1.0.0\"",
      "artifact-support": [
        "source",
        "collected"
      ]
    }
  ],
  "api-endpoints": {
    "CoSERVRequestResponse": "/endorsement-distribution/v1/coserv/{\
                                                              query}"
  },
  "result-verification-key": [
    {
      "alg": "ES256",
      "crv": "P-256",
      "kty": "EC",
      "x": "usWxHK2PmfnHKwXPS54m0kTcGJ90UiglWiGahtagnv8",
      "y": "IBOL-C3BttVivg-lSreASjpkttcsz-1rb7btKLv8EX4",
      "kid": "key1"
    }
  ]
}
</pre><a href="#section-6.1.1.3-5" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1.3-6">Example HTTP request for retrieving the discovery document in CBOR format:<a href="#section-6.1.1.3-6" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.1.3-7">
<pre>
GET /.well-known/coserv-configuration HTTP/1.1
Host: endorsements-distributor.example
Accept: application/coserv-discovery+cbor
</pre><a href="#section-6.1.1.3-7" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1.3-8">Corresponding HTTP response:<a href="#section-6.1.1.3-8" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.1.3-9">
<pre>
HTTP/1.1 200 OK
Content-Type: application/coserv-discovery+cbor

Body (in CBOR Extended Diagnostic Notation (EDN))

=============== NOTE: '\' line wrapping per RFC 8792 ================

{
  / version / 1: "1.2.3-beta",
  / capabilities / 2: [
    {
      / media-type / 1: "application/coserv+cose; profile=\"tag:\
                                vendor.com,2025:cc_platform#1.0.0\"",
      / artifact-support / 2: [
        "source",
        "collected"
      ]
    }
  ],
  / api-endpoints / 3: {
    "CoSERVRequestResponse": "/endorsement-distribution/v1/coserv/{\
                                                              query}"
  },
  / result-verification-key / 4: [
    {
      / kty / 1: 2,
      / alg / 3: -7,
      / crv / -1: 1,
      / x / -2: h'1A2B3C4D',
      / y / -3: h'5E6F7A8B',
      / kid / 2: h'ABCDEF1234'
    }
  ]
}
</pre><a href="#section-6.1.1.3-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="secrrapiquery">
<section id="section-6.1.2">
          <h4 id="name-execute-query">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-execute-query" class="section-name selfRef">Execute Query</a>
          </h4>
<p id="section-6.1.2-1">This endpoint executes a single CoSERV query and returns a CoSERV result set.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">The HTTP method is <code>GET</code>.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.2-3">The URL path is formed of the discovered <code>coserv</code> endpoint (as set out in <a href="#secrrapidisco" class="auto internal xref">Section 6.1.1</a>), where the <code>{query}</code> template variable is substituted with the CoSERV query to be executed, which is represented as a Base64Url encoding of the query's serialized CBOR byte sequence.<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<p id="section-6.1.2-4">There are no additional URL query parameters.<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
<p id="section-6.1.2-5">Clients <span class="bcp14">MUST</span> set the HTTP <code>Accept</code> header to a suitably-profiled <code>application/coserv+cose</code> or <code>application/coserv+cbor</code> media type.<a href="#section-6.1.2-5" class="pilcrow">¶</a></p>
<p id="section-6.1.2-6">Endpoint implementations <span class="bcp14">MUST</span> respond with an HTTP status code and response body according to one of the subheadings below.<a href="#section-6.1.2-6" class="pilcrow">¶</a></p>
<div id="responses">
<section id="section-6.1.2.1">
            <h5 id="name-responses">
<a href="#section-6.1.2.1" class="section-number selfRef">6.1.2.1. </a><a href="#name-responses" class="section-name selfRef">Responses</a>
            </h5>
<div id="successful-transaction-200">
<section id="section-6.1.2.1.1">
              <h6 id="name-successful-transaction-200">
<a href="#section-6.1.2.1.1" class="section-number selfRef">6.1.2.1.1. </a><a href="#name-successful-transaction-200" class="section-name selfRef">Successful Transaction (200)</a>
              </h6>
<p id="section-6.1.2.1.1-1">This response indicates that the CoSERV query was executed successfully.<a href="#section-6.1.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2.1.1-2">Example HTTP request:<a href="#section-6.1.2.1.1-2" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.2.1.1-3">
<pre>
# NOTE: '\' line wrapping per RFC 8792

GET /coserv/ogB4I3R... HTTP/1.1
Host: endorsements-distributor.example
Accept: application/coserv+cose; \
        profile="tag:vendor.com,2025:cc_platform#1.0.0"
</pre><a href="#section-6.1.2.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2.1.1-4">Example HTTP response:<a href="#section-6.1.2.1.1-4" class="pilcrow">¶</a></p>
<div class="breakable lang-http-message sourcecode" id="section-6.1.2.1.1-5">
<pre>
# NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 200 OK
Content-Type: application/coserv+cose; \
              profile="tag:vendor.com,2025:cc_platform#1.0.0"

Body (in CBOR Extended Diagnostic Notation (EDN))

/ signed-coserv / 18([
  / protected / &lt;&lt; {
    / alg / 1: -7 / ECDSA 256 /,
    / cty / 2 : "application/coserv+cbor"
  } &gt;&gt;,
  / unprotected / {},
  / payload / &lt;&lt;
{
  / profile / 0: "tag:example.com,2025:cc-platform#1.0.0",
  / query /   1: {
    / artifact-type /         0: 2, / reference-values /
    / environment-selector /  1: {
      / class / 0: [ [
        {
          / class-id /  0: 560(h'00112233'),  / tagged-bytes /
          / vendor /    1: "Example Vendor",
          / model /     2: "Example Model"
        }
      ] ]
    },
    / result-type / 2: 0 / collected-artifacts /
  },
  / results / 2: {
    / rvq / 0: [
      {
        / authorities / 1: [ 560(h'abcdef') ],
        / reference-triple / 2: [
          / environment-map / {
            / class / 0: {
              / class-id /  0: 560(h'00112233'),
              / vendor /    1: "Example Vendor",
              / model /     2: "Example Model"
            }
          },
          [
            / measurement-map / {
              / mval / 1: {
                / digests / 2: [
                  [ 1, h'aa' ],
                  [ 2, h'bb' ]
                ],
                / name / 11: "Component A"
              }
            },
            / measurement-map / {
              / mval / 1: {
                / digests / 2: [
                  [ 1, h'cc' ],
                  [ 2, h'dd' ]
                ],
                / name / 11: "Component B"
              }
            }
          ]
        ]
      }
    ],
    / expiry / 10: 0("2030-12-13T18:30:02Z")
  }
}
  &gt;&gt;,
  / signature / h'face5190'
])
</pre><a href="#section-6.1.2.1.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="failure-to-validate-query-400">
<section id="section-6.1.2.1.2">
              <h6 id="name-failure-to-validate-query-4">
<a href="#section-6.1.2.1.2" class="section-number selfRef">6.1.2.1.2. </a><a href="#name-failure-to-validate-query-4" class="section-name selfRef">Failure to Validate Query (400)</a>
              </h6>
<p id="section-6.1.2.1.2-1">This response indicates that the supplied query is badly formed.<a href="#section-6.1.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2.1.2-2">Example HTTP request:<a href="#section-6.1.2.1.2-2" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.2.1.2-3">
<pre>
# NOTE: '\' line wrapping per RFC 8792

GET /coserv/badquery... HTTP/1.1
Host: endorsements-distributor.example
Accept: application/coserv+cose; \
        profile="tag:vendor.com,2025:cc_platform#1.0.0"
</pre><a href="#section-6.1.2.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2.1.2-4">Example HTTP response:<a href="#section-6.1.2.1.2-4" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.2.1.2-5">
<pre>
# NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 400 Bad Request
Content-Type: application/concise-problem-details+cbor

Body (in CBOR Extended Diagnostic Notation (EDN))

{
  / title /  -1: "Query validation failed",
  / detail / -2: "The query payload is not in CBOR format"
}
</pre><a href="#section-6.1.2.1.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="failure-to-negotiate-profile-406">
<section id="section-6.1.2.1.3">
              <h6 id="name-failure-to-negotiate-profil">
<a href="#section-6.1.2.1.3" class="section-number selfRef">6.1.2.1.3. </a><a href="#name-failure-to-negotiate-profil" class="section-name selfRef">Failure to Negotiate Profile (406)</a>
              </h6>
<p id="section-6.1.2.1.3-1">This response indicates that the client has specified a CoSERV profile that is not understood or serviceable by the receiving endpoint implementation.<a href="#section-6.1.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2.1.3-2">Example HTTP request:<a href="#section-6.1.2.1.3-2" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.2.1.3-3">
<pre>
# NOTE: '\' line wrapping per RFC 8792

GET /coserv/ogB4I3R... HTTP/1.1
Host: endorsements-distributor.example
Accept: application/coserv+cose; \
        profile="tag:vendor.com,2025:cc_platform#2.0.0"
</pre><a href="#section-6.1.2.1.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2.1.3-4">Example HTTP response:<a href="#section-6.1.2.1.3-4" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-6.1.2.1.3-5">
<pre>
# NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 406 Not Acceptable
Content-Type: application/concise-problem-details+cbor

Body (in CBOR Extended Diagnostic Notation (EDN))

{
  / title /  -1: "Unsupported profile",
  / detail / -2: "Profile tag:vendor.com,2025:cc_platform#2.0.0 \
                  not supported",
}
</pre><a href="#section-6.1.2.1.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="secrrapicaching">
<section id="section-6.1.3">
          <h4 id="name-caching">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-caching" class="section-name selfRef">Caching</a>
          </h4>
<p id="section-6.1.3-1">In practical usage, the artifacts transacted via CoSERV queries (such as trust anchors and reference values) may change significantly less often than they are used.
For example, a Verifier needs to use the artifacts whenever it needs to verify or appraise Evidence from an Attester.
This might be a very frequent operation, for which a low latency is desirable.
By contrast, the artifacts themselves would vary only as a consequence of impactful changes to the Attester's desired state or environment.
One example of such an impactful change might be the roll-out of a firmware update, which would result in a new reference value for the impacted firmware component(s).
Such changes would tend to be relatively infrequent.
The caching of CoSERV artifacts is therefore beneficial for overall system performance.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3-2">CoSERV is designed to facilitate both client-side and server-side caching by use of the standard HTTP caching mechanisms specified in <span>[<a href="#STD98" class="cite xref">STD98</a>]</span>.
This includes use of the HTTP <code>Cache-Control</code> header and its associated directives.
It also includes the use of entity-tags (ETags).
The following features of CoSERV and its HTTP binding are specifically designed to favor caching implementations:<a href="#section-6.1.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3-3.1">
              <p id="section-6.1.3-3.1.1">CoSERV queries form stable URL paths.
As specified in <a href="#secencoding" class="auto internal xref">Section 4.5</a>, any given CoSERV query will always serialize to the same fixed sequence of bytes.
This allows queries to be used as canonical and stable resource identifiers, which in turn allows them to function effectively as cache keys.<a href="#section-6.1.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-3.2">
              <p id="section-6.1.3-3.2.1">The result set is cryptographically bound to the query.
As specified in <a href="#signed-coserv" class="auto internal xref">Section 4.6</a>, the origin server is required to return a signed response that combines the result set with the client's original query, in any deployment where untrusted intermediaries might exist.
This means that the client can always verify the integrity of the result on an end-to-end basis, even in the presence of caching infrastructure.<a href="#section-6.1.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-3.3">
              <p id="section-6.1.3-3.3.1">The use of safe HTTP methods.
CoSERV queries are executed as read-only operations using HTTP <code>GET</code>.
The execution of a query does not modify any state on the server, which creates more opportunities for the re-use of cached results.<a href="#section-6.1.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="http-caching-and-result-set-expiry">
<section id="section-6.1.3.1">
            <h5 id="name-http-caching-and-result-set">
<a href="#section-6.1.3.1" class="section-number selfRef">6.1.3.1. </a><a href="#name-http-caching-and-result-set" class="section-name selfRef">HTTP Caching and Result Set Expiry</a>
            </h5>
<p id="section-6.1.3.1-1">CoSERV's data model includes a mandatory expiration timestamp on every result set.
This is an authoritative marker of the point in time at which the entire result set becomes invalid, and the query must be re-executed to obtain fresh results.
This timestamp is established by the origin server.<a href="#section-6.1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1-2">In the presence of HTTP caching infrastructure, the origin server <span class="bcp14">MUST NOT</span> set HTTP cache directives (e.g. <code>Cache-Control: max-age</code>, <code>Expires</code>) such that the freshness lifetime of the HTTP response exceeds the result set expiry timestamp contained within the CoSERV result set payload.<a href="#section-6.1.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-http-messages-with-caching">
<section id="section-6.1.3.2">
            <h5 id="name-example-http-messages-with-">
<a href="#section-6.1.3.2" class="section-number selfRef">6.1.3.2. </a><a href="#name-example-http-messages-with-" class="section-name selfRef">Example HTTP Messages with Caching</a>
            </h5>
<p id="section-6.1.3.2-1">This section illustrates a caching scenario.<a href="#section-6.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.2-2">In this example, the CoSERV HTTP API server endpoint is hosted by an HTTP origin (coserv.example), while a reverse proxy (cache.example) operates a public cache in front of the origin.<a href="#section-6.1.3.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.2-3">Client A sends a request using a specific CoSERV query.
As the reverse proxy has a "cache miss" for the resource, it forwards the request to the origin.
The origin then constructs the response and returns it to the proxy.
The response includes cache-control headers that are compatible with the time-to-live associated with the computed result set.
For the purposes of this example, the HTTP response <code>max-age</code> has been set to 10 minutes and the <code>s-maxage</code> to 1 hour.
This means that the origin allows intermediaries (e.g., its CDN) to cache this resource for longer than the client.
The result is different caching behaviours between clients and intermediaries, which reduces the load on the origin by enabling CDNs to cache content for longer, while ensuring that clients receive fresher content.
Before forwarding it to the client, the proxy stores the response in its cache using the request URI as the cache key alongside the entry's time-to-live value.<a href="#section-6.1.3.2-3" class="pilcrow">¶</a></p>
<aside id="section-6.1.3.2-4">
              <p id="section-6.1.3.2-4.1">This "differential caching" strategy could be useful if the origin and its CDN have control plane APIs that the origin owner can use to instruct the CDN operator to purge certain cached entries <span>[<a href="#RFC8007" class="cite xref">RFC8007</a>]</span>. For instance, in CoSERV, this feature could be used in case of an unexpected revocation.<a href="#section-6.1.3.2-4.1" class="pilcrow">¶</a></p>
</aside>
<div id="section-6.1.3.2-5">
              <div class="alignLeft art-svg artwork" id="section-6.1.3.2-5.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="576" width="576" viewBox="0 0 576 576" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 40,64 L 40,560" fill="none" stroke="black"></path>
                  <path d="M 200,64 L 200,96" fill="none" stroke="black"></path>
                  <path d="M 224,112 L 224,560" fill="none" stroke="black"></path>
                  <path d="M 248,64 L 248,96" fill="none" stroke="black"></path>
                  <path d="M 408,80 L 408,560" fill="none" stroke="black"></path>
                  <path d="M 216,48 L 232,48" fill="none" stroke="black"></path>
                  <path d="M 216,80 L 232,80" fill="none" stroke="black"></path>
                  <path d="M 216,112 L 232,112" fill="none" stroke="black"></path>
                  <path d="M 40,144 L 216,144" fill="none" stroke="black"></path>
                  <path d="M 224,160 L 248,160" fill="none" stroke="black"></path>
                  <path d="M 232,192 L 248,192" fill="none" stroke="black"></path>
                  <path d="M 224,256 L 400,256" fill="none" stroke="black"></path>
                  <path d="M 408,272 L 432,272" fill="none" stroke="black"></path>
                  <path d="M 416,304 L 432,304" fill="none" stroke="black"></path>
                  <path d="M 232,384 L 408,384" fill="none" stroke="black"></path>
                  <path d="M 224,432 L 248,432" fill="none" stroke="black"></path>
                  <path d="M 232,464 L 248,464" fill="none" stroke="black"></path>
                  <path d="M 48,544 L 224,544" fill="none" stroke="black"></path>
                  <path d="M 216,48 C 207.16936,48 200,55.16936 200,64" fill="none" stroke="black"></path>
                  <path d="M 232,48 C 240.83064,48 248,55.16936 248,64" fill="none" stroke="black"></path>
                  <path d="M 408,48 C 399.16936,48 392,55.16936 392,64" fill="none" stroke="black"></path>
                  <path d="M 408,48 C 416.83064,48 424,55.16936 424,64" fill="none" stroke="black"></path>
                  <path d="M 216,80 C 207.16936,80 200,72.83064 200,64" fill="none" stroke="black"></path>
                  <path d="M 232,80 C 240.83064,80 248,72.83064 248,64" fill="none" stroke="black"></path>
                  <path d="M 408,80 C 399.16936,80 392,72.83064 392,64" fill="none" stroke="black"></path>
                  <path d="M 408,80 C 416.83064,80 424,72.83064 424,64" fill="none" stroke="black"></path>
                  <path d="M 216,112 C 207.16936,112 200,104.83064 200,96" fill="none" stroke="black"></path>
                  <path d="M 232,112 C 240.83064,112 248,104.83064 248,96" fill="none" stroke="black"></path>
                  <path d="M 248,160 C 256.83064,160 264,167.16936 264,176" fill="none" stroke="black"></path>
                  <path d="M 248,192 C 256.83064,192 264,184.83064 264,176" fill="none" stroke="black"></path>
                  <path d="M 432,272 C 440.83064,272 448,279.16936 448,288" fill="none" stroke="black"></path>
                  <path d="M 432,304 C 440.83064,304 448,296.83064 448,288" fill="none" stroke="black"></path>
                  <path d="M 248,432 C 256.83064,432 264,439.16936 264,448" fill="none" stroke="black"></path>
                  <path d="M 248,464 C 256.83064,464 264,456.83064 264,448" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="424,304 412,298.4 412,309.6" fill="black" transform="rotate(180,416,304)"></polygon>
                  <polygon class="arrowhead" points="408,256 396,250.4 396,261.6" fill="black" transform="rotate(0,400,256)"></polygon>
                  <polygon class="arrowhead" points="240,464 228,458.4 228,469.6" fill="black" transform="rotate(180,232,464)"></polygon>
                  <polygon class="arrowhead" points="240,384 228,378.4 228,389.6" fill="black" transform="rotate(180,232,384)"></polygon>
                  <polygon class="arrowhead" points="240,192 228,186.4 228,197.6" fill="black" transform="rotate(180,232,192)"></polygon>
                  <polygon class="arrowhead" points="224,144 212,138.4 212,149.6" fill="black" transform="rotate(0,216,144)"></polygon>
                  <polygon class="arrowhead" points="56,544 44,538.4 44,549.6" fill="black" transform="rotate(180,48,544)"></polygon>
                  <circle cx="40" cy="64" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <g class="text">
                    <text x="28" y="36">client</text>
                    <text x="64" y="36">A</text>
                    <text x="224" y="36">cache.example</text>
                    <text x="412" y="36">coserv.example</text>
                    <text x="80" y="132">GET</text>
                    <text x="144" y="132">ogB4I3RhZ..</text>
                    <text x="312" y="148">lookup(obB4I3RhZ..)</text>
                    <text x="252" y="212">MISS</text>
                    <text x="264" y="244">GET</text>
                    <text x="328" y="244">ogB4I3RhZ..</text>
                    <text x="488" y="276">compute</text>
                    <text x="484" y="292">result</text>
                    <text x="472" y="308">set</text>
                    <text x="256" y="324">200</text>
                    <text x="284" y="324">OK</text>
                    <text x="448" y="324">(expiry</text>
                    <text x="488" y="324">=</text>
                    <text x="512" y="324">now</text>
                    <text x="536" y="324">+</text>
                    <text x="560" y="324">1h)</text>
                    <text x="260" y="340">C-C:</text>
                    <text x="332" y="340">max-age=600,</text>
                    <text x="336" y="356">s-maxage=3600</text>
                    <text x="292" y="372">#6.18([...])</text>
                    <text x="316" y="420">store(K=obB4I3RhZ..,</text>
                    <text x="340" y="436">V=#6.18([...],</text>
                    <text x="320" y="452">TTL=3600)</text>
                    <text x="72" y="484">200</text>
                    <text x="100" y="484">OK</text>
                    <text x="76" y="500">C-C:</text>
                    <text x="148" y="500">max-age=600,</text>
                    <text x="152" y="516">s-maxage=3600</text>
                    <text x="108" y="532">#6.18([...])</text>
                  </g>
                </svg><a href="#section-6.1.3.2-5.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-6.1.3.2-6">At a later point, after 2 minutes, a different client B makes the same request.
This time, the request generates a "cache hit" event on the proxy.
The response is therefore served from the public cache, bypassing the origin.
This reduces the load on the origin, where computing the result set is generally costly, as well as reducing the overall latency of the transaction.
Client B operates a local cache, where it stores a copy of the response.<a href="#section-6.1.3.2-6" class="pilcrow">¶</a></p>
<div id="section-6.1.3.2-7">
              <div class="alignLeft art-svg artwork" id="section-6.1.3.2-7.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="416" width="472" viewBox="0 0 472 416" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 24,80 L 24,96" fill="none" stroke="black"></path>
                  <path d="M 40,112 L 40,400" fill="none" stroke="black"></path>
                  <path d="M 56,80 L 56,96" fill="none" stroke="black"></path>
                  <path d="M 200,64 L 200,96" fill="none" stroke="black"></path>
                  <path d="M 224,112 L 224,400" fill="none" stroke="black"></path>
                  <path d="M 248,64 L 248,96" fill="none" stroke="black"></path>
                  <path d="M 408,80 L 408,400" fill="none" stroke="black"></path>
                  <path d="M 216,48 L 232,48" fill="none" stroke="black"></path>
                  <path d="M 216,80 L 232,80" fill="none" stroke="black"></path>
                  <path d="M 216,112 L 232,112" fill="none" stroke="black"></path>
                  <path d="M 40,144 L 216,144" fill="none" stroke="black"></path>
                  <path d="M 224,160 L 248,160" fill="none" stroke="black"></path>
                  <path d="M 232,192 L 248,192" fill="none" stroke="black"></path>
                  <path d="M 48,304 L 224,304" fill="none" stroke="black"></path>
                  <path d="M 40,352 L 64,352" fill="none" stroke="black"></path>
                  <path d="M 48,384 L 64,384" fill="none" stroke="black"></path>
                  <path d="M 216,48 C 207.16936,48 200,55.16936 200,64" fill="none" stroke="black"></path>
                  <path d="M 232,48 C 240.83064,48 248,55.16936 248,64" fill="none" stroke="black"></path>
                  <path d="M 408,48 C 399.16936,48 392,55.16936 392,64" fill="none" stroke="black"></path>
                  <path d="M 408,48 C 416.83064,48 424,55.16936 424,64" fill="none" stroke="black"></path>
                  <path d="M 40,64 C 31.16936,64 24,71.16936 24,80" fill="none" stroke="black"></path>
                  <path d="M 40,64 C 48.83064,64 56,71.16936 56,80" fill="none" stroke="black"></path>
                  <path d="M 216,80 C 207.16936,80 200,72.83064 200,64" fill="none" stroke="black"></path>
                  <path d="M 232,80 C 240.83064,80 248,72.83064 248,64" fill="none" stroke="black"></path>
                  <path d="M 408,80 C 399.16936,80 392,72.83064 392,64" fill="none" stroke="black"></path>
                  <path d="M 408,80 C 416.83064,80 424,72.83064 424,64" fill="none" stroke="black"></path>
                  <path d="M 40,96 C 31.16936,96 24,88.83064 24,80" fill="none" stroke="black"></path>
                  <path d="M 40,96 C 48.83064,96 56,88.83064 56,80" fill="none" stroke="black"></path>
                  <path d="M 40,112 C 31.16936,112 24,104.83064 24,96" fill="none" stroke="black"></path>
                  <path d="M 40,112 C 48.83064,112 56,104.83064 56,96" fill="none" stroke="black"></path>
                  <path d="M 216,112 C 207.16936,112 200,104.83064 200,96" fill="none" stroke="black"></path>
                  <path d="M 232,112 C 240.83064,112 248,104.83064 248,96" fill="none" stroke="black"></path>
                  <path d="M 248,160 C 256.83064,160 264,167.16936 264,176" fill="none" stroke="black"></path>
                  <path d="M 248,192 C 256.83064,192 264,184.83064 264,176" fill="none" stroke="black"></path>
                  <path d="M 64,352 C 72.83064,352 80,359.16936 80,368" fill="none" stroke="black"></path>
                  <path d="M 64,384 C 72.83064,384 80,376.83064 80,368" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="240,192 228,186.4 228,197.6" fill="black" transform="rotate(180,232,192)"></polygon>
                  <polygon class="arrowhead" points="224,144 212,138.4 212,149.6" fill="black" transform="rotate(0,216,144)"></polygon>
                  <polygon class="arrowhead" points="56,384 44,378.4 44,389.6" fill="black" transform="rotate(180,48,384)"></polygon>
                  <polygon class="arrowhead" points="56,304 44,298.4 44,309.6" fill="black" transform="rotate(180,48,304)"></polygon>
                  <g class="text">
                    <text x="28" y="36">client</text>
                    <text x="64" y="36">B</text>
                    <text x="224" y="36">cache.example</text>
                    <text x="412" y="36">coserv.example</text>
                    <text x="80" y="132">GET</text>
                    <text x="144" y="132">ogB4I3RhZ..</text>
                    <text x="312" y="148">lookup(obB4I3RhZ..)</text>
                    <text x="248" y="212">HIT</text>
                    <text x="72" y="228">200</text>
                    <text x="100" y="228">OK</text>
                    <text x="76" y="244">C-C:</text>
                    <text x="148" y="244">max-age=480,</text>
                    <text x="152" y="260">s-maxage=3480</text>
                    <text x="80" y="276">Etag:</text>
                    <text x="128" y="276">"xyz"</text>
                    <text x="108" y="292">#6.18([...])</text>
                    <text x="132" y="340">store(K=obB4I3RhZ..,</text>
                    <text x="156" y="356">V=#6.18([...],</text>
                    <text x="132" y="372">TTL=480)</text>
                  </g>
                </svg><a href="#section-6.1.3.2-7.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-6.1.3.2-8">After 9 more minutes, B is instructed to make the same request again.
The request generates a "cache hit" event on the local cache.
However, the cached resource is become stale and needs to be revalidated.
Therefore, B sends a conditional request to the proxy.
The request generates a "cache hit" event on the proxy where the resource is still fresh due to the differential caching behaviour dictated by the original response from the origin.
The proxy returns a 304 (Not modified) status code, which instructs the client to reuse its local copy of the response.<a href="#section-6.1.3.2-8" class="pilcrow">¶</a></p>
<div id="section-6.1.3.2-9">
              <div class="alignLeft art-svg artwork" id="section-6.1.3.2-9.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="416" width="480" viewBox="0 0 480 416" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 24,80 L 24,96" fill="none" stroke="black"></path>
                  <path d="M 40,112 L 40,400" fill="none" stroke="black"></path>
                  <path d="M 56,80 L 56,96" fill="none" stroke="black"></path>
                  <path d="M 200,64 L 200,96" fill="none" stroke="black"></path>
                  <path d="M 224,112 L 224,400" fill="none" stroke="black"></path>
                  <path d="M 248,64 L 248,96" fill="none" stroke="black"></path>
                  <path d="M 408,80 L 408,400" fill="none" stroke="black"></path>
                  <path d="M 216,48 L 232,48" fill="none" stroke="black"></path>
                  <path d="M 216,80 L 232,80" fill="none" stroke="black"></path>
                  <path d="M 216,112 L 232,112" fill="none" stroke="black"></path>
                  <path d="M 40,144 L 64,144" fill="none" stroke="black"></path>
                  <path d="M 48,176 L 64,176" fill="none" stroke="black"></path>
                  <path d="M 40,256 L 216,256" fill="none" stroke="black"></path>
                  <path d="M 224,272 L 248,272" fill="none" stroke="black"></path>
                  <path d="M 232,304 L 248,304" fill="none" stroke="black"></path>
                  <path d="M 48,384 L 224,384" fill="none" stroke="black"></path>
                  <path d="M 216,48 C 207.16936,48 200,55.16936 200,64" fill="none" stroke="black"></path>
                  <path d="M 232,48 C 240.83064,48 248,55.16936 248,64" fill="none" stroke="black"></path>
                  <path d="M 408,48 C 399.16936,48 392,55.16936 392,64" fill="none" stroke="black"></path>
                  <path d="M 408,48 C 416.83064,48 424,55.16936 424,64" fill="none" stroke="black"></path>
                  <path d="M 40,64 C 31.16936,64 24,71.16936 24,80" fill="none" stroke="black"></path>
                  <path d="M 40,64 C 48.83064,64 56,71.16936 56,80" fill="none" stroke="black"></path>
                  <path d="M 216,80 C 207.16936,80 200,72.83064 200,64" fill="none" stroke="black"></path>
                  <path d="M 232,80 C 240.83064,80 248,72.83064 248,64" fill="none" stroke="black"></path>
                  <path d="M 408,80 C 399.16936,80 392,72.83064 392,64" fill="none" stroke="black"></path>
                  <path d="M 408,80 C 416.83064,80 424,72.83064 424,64" fill="none" stroke="black"></path>
                  <path d="M 40,96 C 31.16936,96 24,88.83064 24,80" fill="none" stroke="black"></path>
                  <path d="M 40,96 C 48.83064,96 56,88.83064 56,80" fill="none" stroke="black"></path>
                  <path d="M 40,112 C 31.16936,112 24,104.83064 24,96" fill="none" stroke="black"></path>
                  <path d="M 40,112 C 48.83064,112 56,104.83064 56,96" fill="none" stroke="black"></path>
                  <path d="M 216,112 C 207.16936,112 200,104.83064 200,96" fill="none" stroke="black"></path>
                  <path d="M 232,112 C 240.83064,112 248,104.83064 248,96" fill="none" stroke="black"></path>
                  <path d="M 64,144 C 72.83064,144 80,151.16936 80,160" fill="none" stroke="black"></path>
                  <path d="M 64,176 C 72.83064,176 80,168.83064 80,160" fill="none" stroke="black"></path>
                  <path d="M 248,272 C 256.83064,272 264,279.16936 264,288" fill="none" stroke="black"></path>
                  <path d="M 248,304 C 256.83064,304 264,296.83064 264,288" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="240,304 228,298.4 228,309.6" fill="black" transform="rotate(180,232,304)"></polygon>
                  <polygon class="arrowhead" points="224,256 212,250.4 212,261.6" fill="black" transform="rotate(0,216,256)"></polygon>
                  <polygon class="arrowhead" points="56,384 44,378.4 44,389.6" fill="black" transform="rotate(180,48,384)"></polygon>
                  <polygon class="arrowhead" points="56,176 44,170.4 44,181.6" fill="black" transform="rotate(180,48,176)"></polygon>
                  <g class="text">
                    <text x="28" y="36">client</text>
                    <text x="64" y="36">B</text>
                    <text x="232" y="36">cache.example</text>
                    <text x="420" y="36">coserv.example</text>
                    <text x="128" y="132">lookup(obB4I3RhZ..)</text>
                    <text x="64" y="196">HIT</text>
                    <text x="112" y="196">(stale)</text>
                    <text x="64" y="228">GET</text>
                    <text x="128" y="228">ogB4I3RhZ..</text>
                    <text x="128" y="244">If-None-Match:"xyz"</text>
                    <text x="248" y="324">HIT</text>
                    <text x="72" y="340">304</text>
                    <text x="104" y="340">Not</text>
                    <text x="156" y="340">modified</text>
                    <text x="76" y="356">C-C:</text>
                    <text x="140" y="356">max-age=0,</text>
                    <text x="152" y="372">s-maxage=3060</text>
                  </g>
                </svg><a href="#section-6.1.3.2-9.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-7">
      <h2 id="name-implementation-status">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-7-1"><span class="cref" id="rfced">RFC Editor:</span> please remove this section prior to publication.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>.
The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.
Please note that the listing of any individual implementation here does not imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a catalog of available implementations or their features.
Readers are advised to note that other implementations may exist.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">According to <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>, "this will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature.
It is up to the individual working groups to use this information as they see fit".<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="veraison">
<section id="section-7.1">
        <h3 id="name-veraison">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-veraison" class="section-name selfRef">Veraison</a>
        </h3>
<p id="section-7.1-1">Responsible Organisation: Veraison (open source project within the Confidential Computing Consortium).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Location: https://github.com/veraison<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Description: Veraison provides components that can be used to build a Verifier, and also exemplifies adjacent RATS roles such as the Relying Party.
There is an active effort to extend Veraison so that it can act in the capacity of an Endorser or Reference Value Provider, showing how CoSERV can be used as a query language for such services.
This includes library code to assist with the creation, parsing and manipulation of CoSERV queries.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">Level of Maturity: This is a proof-of-concept prototype implementation.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">License: Apache-2.0.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">Coverage: This implementation covers all aspects of the CoSERV query language.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7">Contact: Thomas Fossati, Thomas.Fossati@linaro.org<a href="#section-7.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="seccons">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">CoSERV implements a conveyance protocol for specific categories of Conceptual Message in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, namely Endorsements and Reference Values.
Consequently, it is used only between the Endorser and Verifier roles, or between the Reference Value Provider and Verifier roles of the RATS architecture.
The relevant security considerations are therefore the ones associated with those roles and their interactions.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Certain security characteristics are desirable for interactions between the Verifier and the Endorser or Reference Value Provider.
However, these characteristics would be the province of the specific implementations of these roles, and of the transport protocols in between them.
They would not be the province of the CoSERV data object itself.
Examples of such desirable characteristics might be:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.1">
          <p id="section-8-3.1.1">The Endorser or Reference Value Provider is available to the Verifier when needed.<a href="#section-8-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.2">
          <p id="section-8-3.2.1">The Verifier is authorised to query data from the Endorser or Reference Value Provider.<a href="#section-8-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.3">
          <p id="section-8-3.3.1">Queries cannot be intercepted or undetectably modified by an entity that is interposed between the Verifier and the Endorser or Reference Value Provider.<a href="#section-8-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="in-relation-to-corim">
<section id="section-8.1">
        <h3 id="name-in-relation-to-corim">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-in-relation-to-corim" class="section-name selfRef">In Relation to CoRIM</a>
        </h3>
<p id="section-8.1-1">CoSERV's data model inherits heavily from that of <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>.
CoSERV responses can contain one or more complete CoRIM artifacts.
They can also contain aggregated views that are composed of multiple CoRIM fragments.
The security and privacy considerations set out in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-09#section-11" class="relref">Section 11</a> of [<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span> therefore apply equally to CoSERV.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forming-native-database-queries-from-coserv">
<section id="section-8.2">
        <h3 id="name-forming-native-database-que">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-forming-native-database-que" class="section-name selfRef">Forming Native Database Queries from CoSERV</a>
        </h3>
<p id="section-8.2-1">Implementations should take care when transforming CoSERV queries into native query types that are compatible with their underlying storage technology (such as SQL queries).
There is a risk of injection attacks arising from poorly-formed or maliciously-formed CoSERV queries.
Implementations must ensure that suitable sanitization procedures are in place when performing such translations.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aggregators">
<section id="section-8.3">
        <h3 id="name-aggregators">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-aggregators" class="section-name selfRef">Aggregators</a>
        </h3>
<p id="section-8.3-1">Aggregation (see <a href="#secaggregation" class="auto internal xref">Section 2</a>) is the process of combining artifacts from multiple Endorser or Reference Value Provider sources, which is a necessary step in some supply chains.
CoSERV supports aggregation explicitly at the protocol level, but is agnostic with regards to how (or whether) such support is used.
However, there are specific security considerations for deployments that make use of aggregators.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">When used, aggregators feed Endorsements and Reference Values to the Verifier (possibly via further aggregators).
This means that they act in the Endorser and/or Reference Value Provider roles of RATS, both of which are trusted roles.
Aggregators are therefore trusted components.
Further, since the purpose of an aggregator is to provide a consolidated point of consumption for the Verifier, there is a risk of its becoming a single point of failure or vulnerability.
An aggregator that is unavailable, malfunctioning, or malicious, has the potential to impact the security of the overall deployment.
For example, a malicious aggregator might attempt to impersonate or otherwise subvert the authority of other actors in the supply chain, such as hardware or firmware vendors.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">The intent of CoSERV is for aggregators to provide an optional convenience layer for the Verifier, rather than to be a subversive authority.
The design features of CoSERV can be used alongside judicious deployment practices to mitigate the risks.
An informative and non-exhaustive list of mitigations follows:-<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-4.1">
            <p id="section-8.3-4.1.1"><strong>Use independent chains of trust.</strong>
It is established above that aggregators are trusted components.
This does not mean that they necessarily become a sole or replacement trust authority.
CoSERV's aggregation model allows for deference to other authorities that exist in the supply chain.
This is true even when an aggregator is acting in the Endorser role.
A hardware Endorsement, for example, might be delivered to the Verifier via an aggregator (along with multiple other artifacts, such as Reference Values).
But the authority of that Endorsement can still be chained back to the hardware provider, and this authority can be checked by the Verifier using an independent trust anchor.<a href="#section-8.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-4.2">
            <p id="section-8.3-4.2.1"><strong>Inspect the authority delegation chains.</strong>
The "quads" feature of the CoSERV data model provides explicit tracking of supply chain sources.
Each inner CoMID triple of an aggregated CoSERV response is annotated with an authority delegation chain.
This is a sequence of delegated trust authorities, each of which might be either a further upstream aggregator or a primary supply chain actor.
This information allows the consumer (Verifier) to inspect the provenance of each aggregated result, which can be checked against its own independent record of trustworthy sources.<a href="#section-8.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-4.3">
            <p id="section-8.3-4.3.1"><strong>Use source artifacts.</strong>
CoSERV's aggregation model supports the pass-through of artifacts from upstream supply-chain actors, known as "source artifacts" in the data model.
Source artifacts are passed verbatim in CoSERV, meaning that they retain any original signatures.
This provides another means of checking the provenance and integrity of such artifacts, independently of any signature that is applied to the CoSERV result by the aggregator (see <a href="#signed-coserv" class="auto internal xref">Section 4.6</a>).<a href="#section-8.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-4.4">
            <p id="section-8.3-4.4.1"><strong>Mutual trust between aggregators and primary supply chain actors.</strong>
The default assumption of CoSERV is that trust flows in one direction only: CoSERV consumers trust CoSERV producers, but not the reverse.
When a Verifier sends a CoSERV query to an aggregator, the Verifier is trusting that aggregator, but not the reverse.
Likewise, when an aggregator calls a primary supply chain source (whether using CoSERV or some proprietary mechanism), then the aggregator is trusting that primary supply chain source, but not the reverse.
Indeed, a primary supply chain source might not even be aware of the existence of any aggregator that is consuming artifacts from it, let alone place any trust in such an aggregator.
However, it is perfectly valid for a deployment to deviate from this baseline, provided that the suitable technical and contractual enablers are put in place.
There could exist an aggregator that is trusted - and vouched for - by the primary supply chain actor(s) from which it consumes.
Supply chain actors might even actively provision their artifacts into the aggregator for onward distribution.
The clients of such an aggregator might then be able to make more use of the "shallow trust" model described in <a href="#secaggregation" class="auto internal xref">Section 2</a>, with a greater reliance on collected artifacts rather than source artifacts.<a href="#section-8.3-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-9">
      <h2 id="name-privacy-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-9-1">A CoSERV query can potentially contain privacy-sensitive information.
Specifically, the <code>environment-selector</code> field of the query may reference identifiable Attester instances in some cases.
This concern naturally also extends to the data objects that might be returned to the consumer in response to the query, although the specifications of such data objects are beyond the scope of this document.
Implementations should ensure that appropriate attention is paid to this.
Suitable mitigations include the following:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">
          <p id="section-9-2.1.1">The use of authenticated secure channels between the producers and the consumers of CoSERV queries and returned artifacts.<a href="#section-9-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-2.2">
          <p id="section-9-2.2.1">Collating Attester instances into anonymity groups, and referencing the groups rather than the individual instances.<a href="#section-9-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="aggregators-1">
<section id="section-9.1">
        <h3 id="name-aggregators-2">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-aggregators-2" class="section-name selfRef">Aggregators</a>
        </h3>
<p id="section-9.1-1">Aggregators (as described in <a href="#secaggregation" class="auto internal xref">Section 2</a>) can pose a specific privacy risk.
This is because they necessarily correlate inputs from multiple supply-chain actors, and can observe repeated CoSERV queries over time.
In doing so, an aggregator might be able to infer details about the composition of an Attester's hardware, firmware or software components.
Such details would not be accessible to individual supply-chain actors implementing the Endorser or Reference Value Provider roles.
There is consequently a risk that such inferred details could be misused to create a covert channel.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1"><span class="cref" id="rfced_1">RFC Editor:</span> replace "RFCthis" with the RFC number assigned to this document.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="media-types-registrations">
<section id="section-10.1">
        <h3 id="name-media-types-registrations">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-media-types-registrations" class="section-name selfRef">Media Types Registrations</a>
        </h3>
<p id="section-10.1-1">IANA is requested to add the following media types to the "Media Types" registry <span>[<a href="#IANA.media-types" class="cite xref">IANA.media-types</a>]</span>.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<span id="name-coserv-media-types"></span><div id="tab-mc-regs">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-coserv-media-types" class="selfRef">CoSERV Media Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Template</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>coserv+cbor</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>application/coserv+cbor</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#secdatamodel" class="auto internal xref">Section 4</a> of RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>coserv+cose</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>application/coserv+cose</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#signed-coserv" class="auto internal xref">Section 4.6</a> of RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>coserv-discovery+cbor</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>application/coserv-discovery+cbor</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#secrrapidisco" class="auto internal xref">Section 6.1.1</a> of RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>coserv-discovery+json</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>application/coserv-discovery+json</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#secrrapidisco" class="auto internal xref">Section 6.1.1</a> of RFCthis</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="applicationcoservcbor">
<section id="section-10.1.1">
          <h4 id="name-application-coservcbor">
<a href="#section-10.1.1" class="section-number selfRef">10.1.1. </a><a href="#name-application-coservcbor" class="section-name selfRef"><code>application/coserv+cbor</code></a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.1-1">
            <dt id="section-10.1.1-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.2">
              <p id="section-10.1.1-1.2.1">application<a href="#section-10.1.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.4">
              <p id="section-10.1.1-1.4.1">coserv+cbor<a href="#section-10.1.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.6">
              <p id="section-10.1.1-1.6.1">n/a<a href="#section-10.1.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.8">
              <p id="section-10.1.1-1.8.1">"profile" (CoSERV profile in string format.  OIDs must use the dotted-decimal notation.)<a href="#section-10.1.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.10">
              <p id="section-10.1.1-1.10.1">binary (CBOR)<a href="#section-10.1.1-1.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.12">
              <p id="section-10.1.1-1.12.1"><a href="#seccons" class="auto internal xref">Section 8</a> of RFCthis<a href="#section-10.1.1-1.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.14">
              <p id="section-10.1.1-1.14.1">n/a<a href="#section-10.1.1-1.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.16">
              <p id="section-10.1.1-1.16.1">RFCthis<a href="#section-10.1.1-1.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.18">
              <p id="section-10.1.1-1.18.1">Verifiers, Endorsers, Reference Value Providers<a href="#section-10.1.1-1.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.20">
              <p id="section-10.1.1-1.20.1">The syntax and semantics of fragment identifiers are as specified for "application/cbor". (No fragment identification syntax is currently defined for "application/cbor".)<a href="#section-10.1.1-1.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.21">Person &amp; email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.22">
              <p id="section-10.1.1-1.22.1">RATS WG mailing list (rats@ietf.org)<a href="#section-10.1.1-1.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.23">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.24">
              <p id="section-10.1.1-1.24.1">COMMON<a href="#section-10.1.1-1.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.25">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.26">
              <p id="section-10.1.1-1.26.1">none<a href="#section-10.1.1-1.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.27">Author/Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.28">
              <p id="section-10.1.1-1.28.1">IETF<a href="#section-10.1.1-1.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.29">Provisional registration:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.30">
              <p id="section-10.1.1-1.30.1">no<a href="#section-10.1.1-1.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="applicationcoservcose">
<section id="section-10.1.2">
          <h4 id="name-application-coservcose">
<a href="#section-10.1.2" class="section-number selfRef">10.1.2. </a><a href="#name-application-coservcose" class="section-name selfRef"><code>application/coserv+cose</code></a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.2-1">
            <dt id="section-10.1.2-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.2">
              <p id="section-10.1.2-1.2.1"><code>application</code><a href="#section-10.1.2-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.4">
              <p id="section-10.1.2-1.4.1"><code>coserv+cose</code><a href="#section-10.1.2-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.6">
              <p id="section-10.1.2-1.6.1">n/a (cose-type is explicitly not supported, as it is understood to be "cose-sign1")<a href="#section-10.1.2-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.8">
              <p id="section-10.1.2-1.8.1">"profile" CoSERV profile in string format.
OIDs must use the dotted-decimal notation.
Note that the <code>cose-type</code> parameter is explicitly not supported, as it is understood to be <code>"cose-sign1"</code>.<a href="#section-10.1.2-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.10">
              <p id="section-10.1.2-1.10.1">binary<a href="#section-10.1.2-1.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.12">
              <p id="section-10.1.2-1.12.1"><a href="#seccons" class="auto internal xref">Section 8</a> of RFCthis<a href="#section-10.1.2-1.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.14">
              <p id="section-10.1.2-1.14.1">n/a<a href="#section-10.1.2-1.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.16">
              <p id="section-10.1.2-1.16.1">RFCthis<a href="#section-10.1.2-1.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.18">
              <p id="section-10.1.2-1.18.1">Verifiers, Endorsers, Reference Value Providers<a href="#section-10.1.2-1.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.20">
              <p id="section-10.1.2-1.20.1">n/a<a href="#section-10.1.2-1.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.21">Person and email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.22">
              <p id="section-10.1.2-1.22.1">RATS WG mailing list (rats@ietf.org)<a href="#section-10.1.2-1.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.23">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.24">
              <p id="section-10.1.2-1.24.1">COMMON<a href="#section-10.1.2-1.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.25">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.26">
              <p id="section-10.1.2-1.26.1">none<a href="#section-10.1.2-1.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.27">Author/Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.28">
              <p id="section-10.1.2-1.28.1">IETF<a href="#section-10.1.2-1.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.29">Provisional registration?</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.30">
              <p id="section-10.1.2-1.30.1">no<a href="#section-10.1.2-1.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="applicationcoserv-discoverycbor">
<section id="section-10.1.3">
          <h4 id="name-application-coserv-discover">
<a href="#section-10.1.3" class="section-number selfRef">10.1.3. </a><a href="#name-application-coserv-discover" class="section-name selfRef"><code>application/coserv-discovery+cbor</code></a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.3-1">
            <dt id="section-10.1.3-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.2">
              <p id="section-10.1.3-1.2.1">application<a href="#section-10.1.3-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.4">
              <p id="section-10.1.3-1.4.1">coserv-discovery+cbor<a href="#section-10.1.3-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.6">
              <p id="section-10.1.3-1.6.1">n/a<a href="#section-10.1.3-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.8">
              <p id="section-10.1.3-1.8.1">n/a<a href="#section-10.1.3-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.10">
              <p id="section-10.1.3-1.10.1">binary (CBOR)<a href="#section-10.1.3-1.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.12">
              <p id="section-10.1.3-1.12.1"><a href="#seccons" class="auto internal xref">Section 8</a> of RFCthis<a href="#section-10.1.3-1.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.14">
              <p id="section-10.1.3-1.14.1">n/a<a href="#section-10.1.3-1.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.16">
              <p id="section-10.1.3-1.16.1">RFCthis<a href="#section-10.1.3-1.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.18">
              <p id="section-10.1.3-1.18.1">Verifiers, Endorsers, Reference Value Providers<a href="#section-10.1.3-1.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.20">
              <p id="section-10.1.3-1.20.1">The syntax and semantics of fragment identifiers are as specified for "application/cbor". (No fragment identification syntax is currently defined for "application/cbor".)<a href="#section-10.1.3-1.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.21">Person &amp; email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.22">
              <p id="section-10.1.3-1.22.1">RATS WG mailing list (rats@ietf.org)<a href="#section-10.1.3-1.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.23">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.24">
              <p id="section-10.1.3-1.24.1">COMMON<a href="#section-10.1.3-1.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.25">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.26">
              <p id="section-10.1.3-1.26.1">none<a href="#section-10.1.3-1.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.27">Author/Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.28">
              <p id="section-10.1.3-1.28.1">IETF<a href="#section-10.1.3-1.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.29">Provisional registration:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.30">
              <p id="section-10.1.3-1.30.1">no<a href="#section-10.1.3-1.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="applicationcoserv-discoveryjson">
<section id="section-10.1.4">
          <h4 id="name-application-coserv-discovery">
<a href="#section-10.1.4" class="section-number selfRef">10.1.4. </a><a href="#name-application-coserv-discovery" class="section-name selfRef"><code>application/coserv-discovery+json</code></a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.4-1">
            <dt id="section-10.1.4-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.2">
              <p id="section-10.1.4-1.2.1">application<a href="#section-10.1.4-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.4">
              <p id="section-10.1.4-1.4.1">coserv-discovery+json<a href="#section-10.1.4-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.6">
              <p id="section-10.1.4-1.6.1">n/a<a href="#section-10.1.4-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.8">
              <p id="section-10.1.4-1.8.1">n/a<a href="#section-10.1.4-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.10">
              <p id="section-10.1.4-1.10.1">binary (JSON is UTF-8-encoded text)<a href="#section-10.1.4-1.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.12">
              <p id="section-10.1.4-1.12.1"><a href="#seccons" class="auto internal xref">Section 8</a> of RFCthis<a href="#section-10.1.4-1.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.14">
              <p id="section-10.1.4-1.14.1">n/a<a href="#section-10.1.4-1.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.16">
              <p id="section-10.1.4-1.16.1">RFCthis<a href="#section-10.1.4-1.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.18">
              <p id="section-10.1.4-1.18.1">Verifiers, Endorsers, Reference Value Providers<a href="#section-10.1.4-1.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.20">
              <p id="section-10.1.4-1.20.1">The syntax and semantics of fragment identifiers are as specified for "application/json". (No fragment identification syntax is currently defined for "application/json".)<a href="#section-10.1.4-1.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.21">Person &amp; email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.22">
              <p id="section-10.1.4-1.22.1">RATS WG mailing list (rats@ietf.org)<a href="#section-10.1.4-1.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.23">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.24">
              <p id="section-10.1.4-1.24.1">COMMON<a href="#section-10.1.4-1.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.25">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.26">
              <p id="section-10.1.4-1.26.1">none<a href="#section-10.1.4-1.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.27">Author/Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.28">
              <p id="section-10.1.4-1.28.1">IETF<a href="#section-10.1.4-1.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.29">Provisional registration:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.30">
              <p id="section-10.1.4-1.30.1">no<a href="#section-10.1.4-1.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="coap-content-formats">
<section id="section-10.2">
        <h3 id="name-coap-content-formats">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-coap-content-formats" class="section-name selfRef">CoAP Content-Formats</a>
        </h3>
<p id="section-10.2-1">IANA is requested to register the following Content-Format IDs in the "CoAP Content-Formats" registry, within the "Constrained RESTful Environments (CoRE) Parameters" registry group <span>[<a href="#IANA.core-parameters" class="cite xref">IANA.core-parameters</a>]</span>:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<span id="name-new-coap-content-formats"></span><table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-new-coap-content-formats" class="selfRef">New CoAP Content Formats</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Content-Type</th>
              <th class="text-left" rowspan="1" colspan="1">Content Coding</th>
              <th class="text-left" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/coserv+cbor</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#secdatamodel" class="auto internal xref">Section 4</a> of RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/coserv+cose</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">TBD2</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#signed-coserv" class="auto internal xref">Section 4.6</a> of RFCthis</td>
            </tr>
          </tbody>
        </table>
<p id="section-10.2-3">If possible, TBD1 and TBD2 should be assigned in the 256..9999 range.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="well-known-uri-for-coserv-configuration">
<section id="section-10.3">
        <h3 id="name-well-known-uri-for-coserv-c">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-well-known-uri-for-coserv-c" class="section-name selfRef">Well-Known URI for CoSERV Configuration</a>
        </h3>
<p id="section-10.3-1">IANA is requested to register the following in the "Well-Known URIs" registry <span>[<a href="#IANA.well-known-uris" class="cite xref">IANA.well-known-uris</a>]</span>:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">URI suffix: coserv-configuration<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<p id="section-10.3-3">Change controller: IETF<a href="#section-10.3-3" class="pilcrow">¶</a></p>
<p id="section-10.3-4">Specification document: RFCthis<a href="#section-10.3-4" class="pilcrow">¶</a></p>
<p id="section-10.3-5">Related information: N/A<a href="#section-10.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-rats-corim">[I-D.ietf-rats-corim]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Concise Reference Integrity Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-corim-09</span>, <time datetime="2025-10-20" class="refDate">20 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-09">https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-msg-wrap">[I-D.ietf-rats-msg-wrap]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Smith, N.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">D. Glaze</span>, <span class="refTitle">"RATS Conceptual Messages Wrapper (CMW)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-msg-wrap-23</span>, <time datetime="2025-12-11" class="refDate">11 December 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-23">https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-23</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.core-parameters">[IANA.core-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.media-types">[IANA.media-types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Media Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/media-types">https://www.iana.org/assignments/media-types</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.well-known-uris">[IANA.well-known-uris]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Well-Known URIs"</span>, <span>&lt;<a href="https://www.iana.org/assignments/well-known-uris">https://www.iana.org/assignments/well-known-uris</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6570">[RFC6570]</dt>
        <dd>
<span class="refAuthor">Gregorio, J.</span>, <span class="refAuthor">Fielding, R.</span>, <span class="refAuthor">Hadley, M.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">D. Orchard</span>, <span class="refTitle">"URI Template"</span>, <span class="seriesInfo">RFC 6570</span>, <span class="seriesInfo">DOI 10.17487/RFC6570</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6570">https://www.rfc-editor.org/rfc/rfc6570</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8615">https://www.rfc-editor.org/rfc/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEMVER">[SEMVER]</dt>
        <dd>
<span class="refTitle">"Semantic Versioning 2.0.0"</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://semver.org/spec/v2.0.0.html">https://semver.org/spec/v2.0.0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD94">[STD94]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD96">[STD96]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-iotops-mud-rats">[I-D.ietf-iotops-mud-rats]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Richardson, M.</span>, and <span class="refAuthor">P. C. Liu</span>, <span class="refTitle">"MUD-Based RATS Resources Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-iotops-mud-rats-02</span>, <time datetime="2025-11-28" class="refDate">28 November 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-iotops-mud-rats-02">https://datatracker.ietf.org/doc/html/draft-ietf-iotops-mud-rats-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-endorsements">[I-D.ietf-rats-endorsements]</dt>
        <dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Birkholz, H.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"RATS Endorsements"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-endorsements-09</span>, <time datetime="2026-03-02" class="refDate">2 March 2026</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-09">https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6024">[RFC6024]</dt>
        <dd>
<span class="refAuthor">Reddy, R.</span> and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Trust Anchor Management Requirements"</span>, <span class="seriesInfo">RFC 6024</span>, <span class="seriesInfo">DOI 10.17487/RFC6024</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6024">https://www.rfc-editor.org/rfc/rfc6024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7942">https://www.rfc-editor.org/rfc/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8007">[RFC8007]</dt>
        <dd>
<span class="refAuthor">Murray, R.</span> and <span class="refAuthor">B. Niven-Jenkins</span>, <span class="refTitle">"Content Delivery Network Interconnection (CDNI) Control Interface / Triggers"</span>, <span class="seriesInfo">RFC 8007</span>, <span class="seriesInfo">DOI 10.17487/RFC8007</span>, <time datetime="2016-12" class="refDate">December 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8007">https://www.rfc-editor.org/rfc/rfc8007</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9711">[RFC9711]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="seriesInfo">RFC 9711</span>, <span class="seriesInfo">DOI 10.17487/RFC9711</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9711">https://www.rfc-editor.org/rfc/rfc9711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD98">[STD98]</dt>
      <dd>
<div class="refInstance">Internet Standard 98, <span>&lt;<a href="https://www.rfc-editor.org/info/std98">https://www.rfc-editor.org/info/std98</a>&gt;</span>.<br><span>At the time of writing, this STD comprises the following:</span>
</div>
<div class="refInstance" id="RFC9111">
            <span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Caching"</span>, <span class="seriesInfo">STD 98</span>, <span class="seriesInfo">RFC 9111</span>, <span class="seriesInfo">DOI 10.17487/RFC9111</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9111">https://www.rfc-editor.org/info/rfc9111</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="collated-cddl">
<section id="appendix-A">
      <h2 id="name-collated-cddl">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-collated-cddl" class="section-name selfRef">Collated CDDL</a>
      </h2>
<div id="collated-cddl-coserv">
<section id="appendix-A.1">
        <h3 id="name-coserv-data-model-2">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-coserv-data-model-2" class="section-name selfRef">CoSERV Data Model</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.1-1">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

signed-coserv = #6.18([
    protected: bytes .cbor signed-coserv-protected-hdr,
    unprotected: signed-coserv-unprotected-hdr,
    payload: bytes .cbor coserv,
    signature: bytes,
])
signed-coserv-protected-hdr = {
  1 =&gt; int,
  2 =&gt; "application/coserv+cbor" / 10000,
  * cose.label =&gt; cose.values,
}
signed-coserv-unprotected-hdr = {* cose.label =&gt; cose.values}
cose.label = int / text
cose.values = any
coserv = {
  &amp;(profile: 0) =&gt; profile,
  &amp;(query: 1) =&gt; query,
  ? &amp;(results: 2) =&gt; results,
}
profile = comid.oid-type / ~uri
query = {
  &amp;(artifact-type: 0) =&gt; artifact-type,
  &amp;(environment-selector: 1) =&gt; environment-selector-map,
  &amp;(result-type: 2) =&gt; result-type,
}
artifact-type = &amp;(endorsed-values: 0) / &amp;(trust-anchors: 1) / &amp;(\
                                                 reference-values: 2)
result-type = &amp;(collected-artifacts: 0) / &amp;(source-artifacts: 1) / &amp;\
                                                            (both: 2)
results = {
  result-set,
  &amp;(expiry: 10) =&gt; tdate,
  ? &amp;(source-artifacts: 11) =&gt; [+ cmw.cbor-record],
}
result-set //= (reference-values // endorsed-values // trust-anchors)
refval-quad = {
  &amp;(authorities: 1) =&gt; [+ comid.$crypto-key-type-choice],
  &amp;(rv-triple: 2) =&gt; comid.reference-triple-record,
}
reference-values = (&amp;(rvq: 0) =&gt; [* refval-quad])
endval-quad = {
  &amp;(authorities: 1) =&gt; [+ comid.$crypto-key-type-choice],
  &amp;(ev-triple: 2) =&gt; comid.endorsed-triple-record,
}
cond-endval-quad = {
  &amp;(authorities: 1) =&gt; [+ comid.$crypto-key-type-choice],
  &amp;(ce-triple: 2) =&gt; comid.conditional-endorsement-triple-record,
}
endorsed-values = (
  &amp;(evq: 1) =&gt; [* endval-quad],
  &amp;(ceq: 2) =&gt; [* cond-endval-quad],
  )
ak-quad = {
  &amp;(authorities: 1) =&gt; [+ comid.$crypto-key-type-choice],
  &amp;(ak-triple: 2) =&gt; comid.attest-key-triple-record,
}
cots-stmt = {
  &amp;(authorities: 1) =&gt; [+ comid.$crypto-key-type-choice],
  &amp;(cots: 2) =&gt; cots,
}
trust-anchors = (
  &amp;(akq: 3) =&gt; [* ak-quad],
  &amp;(tas: 4) =&gt; [* cots-stmt],
  )
cots = "TODO COTS"
environment-selector-map = {selector}
stateful-class = [
  class: comid.class-map,
  ? measurements: [+ comid.measurement-map],
]
selector //= (&amp;(class: 0) =&gt; [+ stateful-class] // &amp;(instance: 1) =\
        &gt; [+ stateful-instance] // &amp;(group: 2) =&gt; [+ stateful-group])
stateful-instance = [
  instance: comid.$instance-id-type-choice,
  ? measurements: [+ comid.measurement-map],
]
stateful-group = [
  group: comid.$group-id-type-choice,
  ? measurements: [+ comid.measurement-map],
]
cmw.start = cmw.cmw
cmw.cmw = cmw.json-cmw / cmw.cbor-cmw
cmw.json-cmw = cmw.json-record / cmw.json-collection
cmw.cbor-cmw = cmw.cbor-record / cmw.cbor-collection / cmw.$cbor-tag
cmw.json-record = [
  type: cmw.media-type,
  value: cmw.base64url-string,
  ? ind: uint .bits cmw.cm-type,
]
cmw.cbor-record = [
  type: cmw.coap-content-format-type / cmw.media-type,
  value: bytes,
  ? ind: uint .bits cmw.cm-type,
]
cmw.tag-cm-cbor&lt;tn, fmt&gt; = #6.&lt;tn&gt;(bytes .cbor fmt)
cmw.tag-cm-data&lt;tn&gt; = #6.&lt;tn&gt;(bytes)
cmw.json-collection = {
  ? __cmwc_t: ~uri / cmw.oid,
  + &amp;(label: text) =&gt; cmw.json-cmw,
}
cmw.cbor-collection = {
  ? __cmwc_t: ~uri / cmw.oid,
  + &amp;(label: int / text) =&gt; cmw.cbor-cmw,
}
cmw.media-type = text .abnf ("Content-Type" .cat cmw.Content-Type-\
                                                                ABNF)
cmw.base64url-string = text .regexp "[A-Za-z0-9_-]+"
cmw.coap-content-format-type = uint .size 2
cmw.oid = text .regexp "([0-2])((\\.0)|(\\.[1-9][0-9]*))*"
cmw.cm-type = &amp;(
  reference-values: 0,
  endorsements: 1,
  evidence: 2,
  attestation-results: 3,
  appraisal-policy: 4,
)
cmw.Content-Type-ABNF = '

Content-Type   = Media-Type-Name *( *SP ";" *SP parameter )
parameter      = token "=" ( token / quoted-string )

token          = 1*tchar
tchar          = "!" / "#" / "$" / "%" / "&amp;" / "\'" / "*"
               / "+" / "-" / "." / "^" / "_" / "`" / "|" / "~"
               / DIGIT / ALPHA
quoted-string  = %x22 *( qdtext / quoted-pair ) %x22
qdtext         = SP / %x21 / %x23-5B / %x5D-7E
quoted-pair    = "\\" ( SP / VCHAR )

Media-Type-Name = type-name "/" subtype-name

type-name = restricted-name
subtype-name = restricted-name

restricted-name = restricted-name-first *126restricted-name-chars
restricted-name-first  = ALPHA / DIGIT
restricted-name-chars  = ALPHA / DIGIT / "!" / "#" /
                         "$" / "&amp;" / "-" / "^" / "_"
restricted-name-chars =/ "." ; Characters before first dot always
                             ; specify a facet name
restricted-name-chars =/ "+" ; Characters after last plus always
                             ; specify a structured syntax suffix

DIGIT     =  %x30-39           ; 0 - 9
POS-DIGIT =  %x31-39           ; 1 - 9
ALPHA     =  %x41-5A / %x61-7A ; A - Z / a - z
SP        =  %x20
VCHAR     =  %x21-7E           ; printable ASCII (no SP)
'
cmw.$cbor-tag /= cmw.tag-cm-data&lt;1668612070&gt; / cmw.tag-cm-cbor&lt;\
                                         1668612069, cmw.my-evidence&gt;
cmw.my-evidence = {&amp;(eat_nonce: 10) =&gt; bytes .size (8 .. 64)}
comid.concise-mid-tag = {
  ? &amp;(language: 0) =&gt; text,
  &amp;(tag-identity: 1) =&gt; comid.tag-identity-map,
  ? &amp;(entities: 2) =&gt; [+ comid.comid-entity-map],
  ? &amp;(linked-tags: 3) =&gt; [+ comid.linked-tag-map],
  &amp;(triples: 4) =&gt; comid.triples-map,
  * $$concise-mid-tag-extension,
}
comid.attest-key-triple-record = [
  environment: comid.environment-map,
  key-list: [+ comid.$crypto-key-type-choice],
  ? conditions: comid.non-empty&lt;{
            ? &amp;(mkey: 0) =&gt; comid.$measured-element-type-choice,
            ? &amp;(authorized-by: 1) =&gt; [+ comid.$crypto-key-type-\
                                                             choice],
}&gt;,
]
comid.$class-id-type-choice /= comid.tagged-oid-type / comid.tagged-\
                                       uuid-type / comid.tagged-bytes
comid.class-map = comid.non-empty&lt;{
    ? &amp;(class-id: 0) =&gt; comid.$class-id-type-choice,
    ? &amp;(vendor: 1) =&gt; tstr,
    ? &amp;(model: 2) =&gt; tstr,
    ? &amp;(layer: 3) =&gt; uint,
    ? &amp;(index: 4) =&gt; uint,
}&gt;
comid.comid-entity-map = comid.entity-map&lt;comid.$comid-role-type-\
                                choice, $$comid-entity-map-extension&gt;
comid.$comid-role-type-choice /= &amp;(tag-creator: 0) / &amp;(creator: 1) \
                                                   / &amp;(maintainer: 2)
comid.conditional-endorsement-series-triple-record = [
  condition: comid.stateful-environment-record,
  series: [+ comid.conditional-series-record],
]
comid.conditional-series-record = [
  selection: [+ comid.measurement-map],
  addition: [+ comid.measurement-map],
]
comid.COSE_Key = {
  1 =&gt; tstr / int,
  ? 2 =&gt; bstr,
  ? 3 =&gt; tstr / int,
  ? 4 =&gt; [+ tstr / int],
  ? 5 =&gt; bstr,
  * comid.cose-label =&gt; comid.cose-value,
}
comid.cose-label = int / tstr
comid.cose-value = any
comid.coswid-triple-record = [
  comid.environment-map,
  [+ comid.concise-swid-tag-id],
]
comid.concise-swid-tag-id = text / bstr .size 16
comid.$crypto-key-type-choice /= comid.tagged-pkix-base64-key-type \
/ comid.tagged-pkix-base64-cert-type / comid.tagged-pkix-base64-cert\
-path-type / comid.tagged-cose-key-type / comid.tagged-pkix-asn1der-\
cert-type / comid.tagged-key-thumbprint-type / comid.tagged-cert-\
thumbprint-type / comid.tagged-cert-path-thumbprint-type / comid.\
                                                         tagged-bytes
comid.tagged-pkix-base64-key-type = #6.554(tstr)
comid.tagged-pkix-base64-cert-type = #6.555(tstr)
comid.tagged-pkix-base64-cert-path-type = #6.556(tstr)
comid.tagged-key-thumbprint-type = #6.557(comid.digest)
comid.tagged-cose-key-type = #6.558(comid.COSE_Key)
comid.tagged-cert-thumbprint-type = #6.559(comid.digest)
comid.tagged-cert-path-thumbprint-type = #6.561(comid.digest)
comid.tagged-pkix-asn1der-cert-type = #6.562(bstr)
comid.domain-dependency-triple-record = [
  comid.domain-type,
  [+ comid.domain-type],
]
comid.domain-membership-triple-record = [
  domain-id: comid.domain-type,
  members: [+ comid.domain-type],
]
comid.conditional-endorsement-triple-record = [
  conditions: [+ comid.stateful-environment-record],
  endorsements: [+ comid.endorsed-triple-record],
]
comid.domain-type = comid.environment-map
comid.endorsed-triple-record = [
  condition: comid.environment-map,
  endorsement: [+ comid.measurement-map],
]
comid.entity-map&lt;role-type-choice, extension-socket&gt; = {
    &amp;(entity-name: 0) =&gt; comid.$entity-name-type-choice,
    ? &amp;(reg-id: 1) =&gt; uri,
    &amp;(role: 2) =&gt; [+ role-type-choice],
    * extension-socket,
}
comid.$entity-name-type-choice /= text
comid.environment-map = comid.non-empty&lt;{
    ? &amp;(class: 0) =&gt; comid.class-map,
    ? &amp;(instance: 1) =&gt; comid.$instance-id-type-choice,
    ? &amp;(group: 2) =&gt; comid.$group-id-type-choice,
}&gt;
comid.flags-map = {
  ? &amp;(is-configured: 0) =&gt; bool,
  ? &amp;(is-secure: 1) =&gt; bool,
  ? &amp;(is-recovery: 2) =&gt; bool,
  ? &amp;(is-debug: 3) =&gt; bool,
  ? &amp;(is-replay-protected: 4) =&gt; bool,
  ? &amp;(is-integrity-protected: 5) =&gt; bool,
  ? &amp;(is-runtime-meas: 6) =&gt; bool,
  ? &amp;(is-immutable: 7) =&gt; bool,
  ? &amp;(is-tcb: 8) =&gt; bool,
  ? &amp;(is-confidentiality-protected: 9) =&gt; bool,
  * $$flags-map-extension,
}
comid.$group-id-type-choice /= comid.tagged-uuid-type / comid.tagged\
                                                               -bytes
comid.identity-triple-record = [
  environment: comid.environment-map,
  key-list: [+ comid.$crypto-key-type-choice],
  ? conditions: comid.non-empty&lt;{
            ? &amp;(mkey: 0) =&gt; comid.$measured-element-type-choice,
            ? &amp;(authorized-by: 1) =&gt; [+ comid.$crypto-key-type-\
                                                             choice],
}&gt;,
]
comid.$instance-id-type-choice /= comid.tagged-ueid-type / comid.\
tagged-uuid-type / comid.tagged-bytes / comid.tagged-pkix-base64-key\
-type / comid.tagged-pkix-base64-cert-type / comid.tagged-cose-key-\
type / comid.tagged-key-thumbprint-type / comid.tagged-cert-\
                thumbprint-type / comid.tagged-pkix-asn1der-cert-type
comid.ip-addr-type-choice = comid.ip4-addr-type / comid.ip6-addr-type
comid.ip4-addr-type = bytes .size 4
comid.ip6-addr-type = bytes .size 16
comid.int-range-type-choice = int / comid.tagged-int-range
comid.int-range = [
  min: int / comid.negative-inf,
  max: int / comid.positive-inf,
]
comid.tagged-int-range = #6.564(comid.int-range)
comid.positive-inf = null
comid.negative-inf = null
comid.linked-tag-map = {
  &amp;(linked-tag-id: 0) =&gt; comid.$tag-id-type-choice,
  &amp;(tag-rel: 1) =&gt; comid.$tag-rel-type-choice,
}
comid.mac-addr-type-choice = comid.eui48-addr-type / comid.eui64-\
                                                            addr-type
comid.eui48-addr-type = bytes .size 6
comid.eui64-addr-type = bytes .size 8
comid.$measured-element-type-choice /= comid.tagged-oid-type / comid\
                                      .tagged-uuid-type / uint / tstr
comid.measurement-map = {
  ? &amp;(mkey: 0) =&gt; comid.$measured-element-type-choice,
  &amp;(mval: 1) =&gt; comid.measurement-values-map,
  ? &amp;(authorized-by: 2) =&gt; [+ comid.$crypto-key-type-choice],
}
comid.measurement-values-map = comid.non-empty&lt;{
    ? &amp;(version: 0) =&gt; comid.version-map,
    ? &amp;(svn: 1) =&gt; comid.svn-type-choice,
    ? &amp;(digests: 2) =&gt; comid.digests-type,
    ? &amp;(flags: 3) =&gt; comid.flags-map,
    ? (
                  &amp;(raw-value: 4) =&gt; comid.$raw-value-type-choice,
                  ? &amp;(raw-value-mask-DEPRECATED: 5) =&gt; comid.raw-\
                                                     value-mask-type,
          ),
    ? &amp;(mac-addr: 6) =&gt; comid.mac-addr-type-choice,
    ? &amp;(ip-addr: 7) =&gt; comid.ip-addr-type-choice,
    ? &amp;(serial-number: 8) =&gt; text,
    ? &amp;(ueid: 9) =&gt; comid.ueid-type,
    ? &amp;(uuid: 10) =&gt; comid.uuid-type,
    ? &amp;(name: 11) =&gt; text,
    ? &amp;(cryptokeys: 13) =&gt; [+ comid.$crypto-key-type-choice],
    ? &amp;(integrity-registers: 14) =&gt; comid.integrity-registers,
    ? &amp;(int-range: 15) =&gt; comid.int-range-type-choice,
    * $$measurement-values-map-extension,
}&gt;
comid.non-empty&lt;M&gt; = M .and ({+ any =&gt; any})
comid.oid-type = bytes
comid.tagged-oid-type = #6.111(comid.oid-type)
comid.$raw-value-type-choice /= comid.tagged-bytes / comid.tagged-\
                                                     masked-raw-value
comid.raw-value-mask-type = bytes
comid.tagged-masked-raw-value = #6.563([
    value: bytes,
    mask: bytes,
])
comid.reference-triple-record = [
  ref-env: comid.environment-map,
  ref-claims: [+ comid.measurement-map],
]
comid.stateful-environment-record = [
  environment: comid.environment-map,
  claims-list: [+ comid.measurement-map],
]
comid.svn-type = uint
comid.svn = comid.svn-type
comid.min-svn = comid.svn-type
comid.tagged-svn = #6.552(comid.svn)
comid.tagged-min-svn = #6.553(comid.min-svn)
comid.svn-type-choice = comid.svn / comid.tagged-svn / comid.tagged-\
                                                              min-svn
comid.$tag-id-type-choice /= tstr / comid.uuid-type
comid.tag-identity-map = {
  &amp;(tag-id: 0) =&gt; comid.$tag-id-type-choice,
  ? &amp;(tag-version: 1) =&gt; comid.tag-version-type,
}
comid.$tag-rel-type-choice /= &amp;(supplements: 0) / &amp;(replaces: 1)
comid.tag-version-type = uint .default 0
comid.tagged-bytes = #6.560(bytes)
comid.triples-map = comid.non-empty&lt;{
    ? &amp;(reference-triples: 0) =&gt; [+ comid.reference-triple-record],
    ? &amp;(endorsed-triples: 1) =&gt; [+ comid.endorsed-triple-record],
    ? &amp;(identity-triples: 2) =&gt; [+ comid.identity-triple-record],
    ? &amp;(attest-key-triples: 3) =&gt; [+ comid.attest-key-triple-record],
    ? &amp;(dependency-triples: 4) =&gt; [+ comid.domain-dependency-triple-\
                                                             record],
    ? &amp;(membership-triples: 5) =&gt; [+ comid.domain-membership-triple-\
                                                             record],
    ? &amp;(coswid-triples: 6) =&gt; [+ comid.coswid-triple-record],
    ? &amp;(conditional-endorsement-series-triples: 8) =&gt; [+ comid.\
                       conditional-endorsement-series-triple-record],
    ? &amp;(conditional-endorsement-triples: 10) =&gt; [+ comid.conditional\
                                         -endorsement-triple-record],
    * $$triples-map-extension,
}&gt;
comid.ueid-type = bytes .size (7 .. 33)
comid.tagged-ueid-type = #6.550(comid.ueid-type)
comid.uuid-type = bytes .size 16
comid.tagged-uuid-type = #6.37(comid.uuid-type)
comid.version-map = {
  &amp;(version: 0) =&gt; text,
  ? &amp;(version-scheme: 1) =&gt; comid.$version-scheme,
}
comid.digest = [
  alg: int / text,
  val: bytes,
]
comid.digests-type = [+ comid.digest]
comid.integrity-register-id-type-choice = uint / text
comid.integrity-registers = {+ comid.integrity-register-id-type-\
                                        choice =&gt; comid.digests-type}
comid.concise-swid-tag = {
  comid.tag-id =&gt; text / bstr .size 16,
  comid.tag-version =&gt; integer,
  ? comid.corpus =&gt; bool,
  ? comid.patch =&gt; bool,
  ? comid.supplemental =&gt; bool,
  comid.software-name =&gt; text,
  ? comid.software-version =&gt; text,
  ? comid.version-scheme =&gt; comid.$version-scheme,
  ? comid.media =&gt; text,
  ? comid.software-meta =&gt; comid.one-or-more&lt;comid.software-meta-\
                                                              entry&gt;,
  comid.entity =&gt; comid.one-or-more&lt;comid.entity-entry&gt;,
  ? comid.link =&gt; comid.one-or-more&lt;comid.link-entry&gt;,
  ? comid.payload-or-evidence,
  * $$coswid-extension,
  comid.global-attributes,
}
comid.payload-or-evidence //= (comid.payload =&gt; comid.payload-entry \
                           // comid.evidence =&gt; comid.evidence-entry)
comid.any-uri = uri
comid.label = text / int
comid.$version-scheme /= comid.multipartnumeric / comid.\
multipartnumeric-suffix / comid.alphanumeric / comid.decimal / comid\
                                                 .semver / int / text
comid.any-attribute = (comid.label =&gt; comid.one-or-more&lt;text&gt; / \
                                              comid.one-or-more&lt;int&gt;)
comid.one-or-more&lt;T&gt; = T / [2*T]
comid.global-attributes = (
  ? comid.lang =&gt; text,
  * comid.any-attribute,
  )
comid.hash-entry = [
  hash-alg-id: int,
  hash-value: bytes,
]
comid.entity-entry = {
  comid.entity-name =&gt; text,
  ? comid.reg-id =&gt; comid.any-uri,
  comid.role =&gt; comid.one-or-more&lt;comid.$role&gt;,
  ? comid.thumbprint =&gt; comid.hash-entry,
  * $$entity-extension,
  comid.global-attributes,
}
comid.$role /= comid.tag-creator / comid.software-creator / comid.\
aggregator / comid.distributor / comid.licensor / comid.maintainer \
                                                         / int / text
comid.link-entry = {
  ? comid.artifact =&gt; text,
  comid.href =&gt; comid.any-uri,
  ? comid.media =&gt; text,
  ? comid.ownership =&gt; comid.$ownership,
  comid.rel =&gt; comid.$rel,
  ? comid.media-type =&gt; text,
  ? comid.use =&gt; comid.$use,
  * $$link-extension,
  comid.global-attributes,
}
comid.$ownership /= comid.shared / comid.private / comid.abandon / \
                                                           int / text
comid.$rel /= comid.ancestor / comid.component / comid.feature / \
comid.installationmedia / comid.packageinstaller / comid.parent / \
comid.patches / comid.requires / comid.see-also / comid.supersedes \
                          / comid.supplemental / -256 .. 64436 / text
comid.$use /= comid.optional / comid.required / comid.recommended / \
                                                           int / text
comid.software-meta-entry = {
  ? comid.activation-status =&gt; text,
  ? comid.channel-type =&gt; text,
  ? comid.colloquial-version =&gt; text,
  ? comid.description =&gt; text,
  ? comid.edition =&gt; text,
  ? comid.entitlement-data-required =&gt; bool,
  ? comid.entitlement-key =&gt; text,
  ? comid.generator =&gt; text / bstr .size 16,
  ? comid.persistent-id =&gt; text,
  ? comid.product =&gt; text,
  ? comid.product-family =&gt; text,
  ? comid.revision =&gt; text,
  ? comid.summary =&gt; text,
  ? comid.unspsc-code =&gt; text,
  ? comid.unspsc-version =&gt; text,
  * $$software-meta-extension,
  comid.global-attributes,
}
comid.path-elements-group = (
  ? comid.directory =&gt; comid.one-or-more&lt;comid.directory-entry&gt;,
  ? comid.file =&gt; comid.one-or-more&lt;comid.file-entry&gt;,
  )
comid.resource-collection = (
  comid.path-elements-group,
  ? comid.process =&gt; comid.one-or-more&lt;comid.process-entry&gt;,
  ? comid.resource =&gt; comid.one-or-more&lt;comid.resource-entry&gt;,
  * $$resource-collection-extension,
  )
comid.file-entry = {
  comid.filesystem-item,
  ? comid.size =&gt; uint,
  ? comid.file-version =&gt; text,
  ? comid.hash =&gt; comid.hash-entry,
  * $$file-extension,
  comid.global-attributes,
}
comid.directory-entry = {
  comid.filesystem-item,
  ? comid.path-elements =&gt; {comid.path-elements-group},
  * $$directory-extension,
  comid.global-attributes,
}
comid.process-entry = {
  comid.process-name =&gt; text,
  ? comid.pid =&gt; integer,
  * $$process-extension,
  comid.global-attributes,
}
comid.resource-entry = {
  comid.type =&gt; text,
  * $$resource-extension,
  comid.global-attributes,
}
comid.filesystem-item = (
  ? comid.key =&gt; bool,
  ? comid.location =&gt; text,
  comid.fs-name =&gt; text,
  ? comid.root =&gt; text,
  )
comid.payload-entry = {
  comid.resource-collection,
  * $$payload-extension,
  comid.global-attributes,
}
comid.evidence-entry = {
  comid.resource-collection,
  ? comid.date =&gt; comid.integer-time,
  ? comid.device-id =&gt; text,
  ? comid.location =&gt; text,
  * $$evidence-extension,
  comid.global-attributes,
}
comid.integer-time = #6.1(int)
comid.tag-id = 0
comid.software-name = 1
comid.entity = 2
comid.evidence = 3
comid.link = 4
comid.software-meta = 5
comid.payload = 6
comid.hash = 7
comid.corpus = 8
comid.patch = 9
comid.media = 10
comid.supplemental = 11
comid.tag-version = 12
comid.software-version = 13
comid.version-scheme = 14
comid.lang = 15
comid.directory = 16
comid.file = 17
comid.process = 18
comid.resource = 19
comid.size = 20
comid.file-version = 21
comid.key = 22
comid.location = 23
comid.fs-name = 24
comid.root = 25
comid.path-elements = 26
comid.process-name = 27
comid.pid = 28
comid.type = 29
comid.entity-name = 31
comid.reg-id = 32
comid.role = 33
comid.thumbprint = 34
comid.date = 35
comid.device-id = 36
comid.artifact = 37
comid.href = 38
comid.ownership = 39
comid.rel = 40
comid.media-type = 41
comid.use = 42
comid.activation-status = 43
comid.channel-type = 44
comid.colloquial-version = 45
comid.description = 46
comid.edition = 47
comid.entitlement-data-required = 48
comid.entitlement-key = 49
comid.generator = 50
comid.persistent-id = 51
comid.product = 52
comid.product-family = 53
comid.revision = 54
comid.summary = 55
comid.unspsc-code = 56
comid.unspsc-version = 57
comid.multipartnumeric = 1
comid.multipartnumeric-suffix = 2
comid.alphanumeric = 3
comid.decimal = 4
comid.semver = 16384
comid.tag-creator = 1
comid.software-creator = 2
comid.aggregator = 3
comid.distributor = 4
comid.licensor = 5
comid.maintainer = 6
comid.abandon = 1
comid.private = 2
comid.shared = 3
comid.ancestor = 1
comid.component = 2
comid.feature = 3
comid.installationmedia = 4
comid.packageinstaller = 5
comid.parent = 6
comid.patches = 7
comid.requires = 8
comid.see-also = 9
comid.supersedes = 10
comid.optional = 1
comid.required = 2
comid.recommended = 3
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="collated-cddl-discovery">
<section id="appendix-A.2">
        <h3 id="name-api-discovery-data-model">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-api-discovery-data-model" class="section-name selfRef">API Discovery Data Model</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.2-1">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

coserv-well-known-info = {
  version-label =&gt; version,
  capabilities-label =&gt; [+ capability],
  api-endpoints-label =&gt; {+ tstr =&gt; tstr},
  ? result-verification-key-label =&gt; eat.JC&lt;jwk.JWK_Set, cose.\
                                                        COSE_KeySet&gt;,
}
version-label = eat.JC&lt;"version", 1&gt;
capabilities-label = eat.JC&lt;"capabilities", 2&gt;
api-endpoints-label = eat.JC&lt;"api-endpoints", 3&gt;
result-verification-key-label = eat.JC&lt;"result-verification-key", 4&gt;
version = tstr
capability = {
  media-type-label =&gt; cmw.media-type,
  artifact-support-label =&gt; artifact-support,
}
media-type-label = eat.JC&lt;"media-type", 1&gt;
artifact-support-label = eat.JC&lt;"artifact-support", 2&gt;
non-empty-array&lt;M&gt; = M .and ([+ any])
artifact-support = non-empty-array&lt;[
    ? "source",
    ? "collected",
]&gt;
cmw.start = cmw.cmw
cmw.cmw = cmw.json-cmw / cmw.cbor-cmw
cmw.json-cmw = cmw.json-record / cmw.json-collection
cmw.cbor-cmw = cmw.cbor-record / cmw.cbor-collection / cmw.$cbor-tag
cmw.json-record = [
  type: cmw.media-type,
  value: cmw.base64url-string,
  ? ind: uint .bits cmw.cm-type,
]
cmw.cbor-record = [
  type: cmw.coap-content-format-type / cmw.media-type,
  value: bytes,
  ? ind: uint .bits cmw.cm-type,
]
cmw.tag-cm-cbor&lt;tn, fmt&gt; = #6.&lt;tn&gt;(bytes .cbor fmt)
cmw.tag-cm-data&lt;tn&gt; = #6.&lt;tn&gt;(bytes)
cmw.json-collection = {
  ? __cmwc_t: ~uri / cmw.oid,
  + &amp;(label: text) =&gt; cmw.json-cmw,
}
cmw.cbor-collection = {
  ? __cmwc_t: ~uri / cmw.oid,
  + &amp;(label: int / text) =&gt; cmw.cbor-cmw,
}
cmw.media-type = text .abnf ("Content-Type" .cat cmw.Content-Type-\
                                                                ABNF)
cmw.base64url-string = text .regexp "[A-Za-z0-9_-]+"
cmw.coap-content-format-type = uint .size 2
cmw.oid = text .regexp "([0-2])((\\.0)|(\\.[1-9][0-9]*))*"
cmw.cm-type = &amp;(
  reference-values: 0,
  endorsements: 1,
  evidence: 2,
  attestation-results: 3,
  appraisal-policy: 4,
)
cmw.Content-Type-ABNF = '

Content-Type   = Media-Type-Name *( *SP ";" *SP parameter )
parameter      = token "=" ( token / quoted-string )

token          = 1*tchar
tchar          = "!" / "#" / "$" / "%" / "&amp;" / "\'" / "*"
               / "+" / "-" / "." / "^" / "_" / "`" / "|" / "~"
               / DIGIT / ALPHA
quoted-string  = %x22 *( qdtext / quoted-pair ) %x22
qdtext         = SP / %x21 / %x23-5B / %x5D-7E
quoted-pair    = "\\" ( SP / VCHAR )

Media-Type-Name = type-name "/" subtype-name

type-name = restricted-name
subtype-name = restricted-name

restricted-name = restricted-name-first *126restricted-name-chars
restricted-name-first  = ALPHA / DIGIT
restricted-name-chars  = ALPHA / DIGIT / "!" / "#" /
                         "$" / "&amp;" / "-" / "^" / "_"
restricted-name-chars =/ "." ; Characters before first dot always
                             ; specify a facet name
restricted-name-chars =/ "+" ; Characters after last plus always
                             ; specify a structured syntax suffix

DIGIT     =  %x30-39           ; 0 - 9
POS-DIGIT =  %x31-39           ; 1 - 9
ALPHA     =  %x41-5A / %x61-7A ; A - Z / a - z
SP        =  %x20
VCHAR     =  %x21-7E           ; printable ASCII (no SP)
'
cmw.$cbor-tag /= cmw.tag-cm-data&lt;1668612070&gt; / cmw.tag-cm-cbor&lt;\
                                         1668612069, cmw.my-evidence&gt;
cmw.my-evidence = {&amp;(eat_nonce: 10) =&gt; bytes .size (8 .. 64)}
jwk.JWK = {
  "kty" =&gt; tstr,
  ? "use" =&gt; tstr,
  ? "key_ops" =&gt; [* tstr],
  ? "alg" =&gt; tstr,
  ? "kid" =&gt; tstr,
  ? "x5u" =&gt; tstr,
  ? "x5c" =&gt; [* jwk.bytes-b64u],
  ? "x5t" =&gt; jwk.bytes-b64u,
  ? "x5t#S256" =&gt; jwk.bytes-b64u,
  ? jwk.RSA-Key-Fields,
  ? jwk.EC-Key-Fields,
  ? jwk.Symmetric-Key-Fields,
}
jwk.JWK_Set = [+ jwk.JWK]
jwk.RSA-Key-Fields = (
  "n" =&gt; jwk.bytes-b64u,
  "e" =&gt; jwk.bytes-b64u,
  ? "d" =&gt; jwk.bytes-b64u,
  ? "p" =&gt; jwk.bytes-b64u,
  ? "q" =&gt; jwk.bytes-b64u,
  ? "dp" =&gt; jwk.bytes-b64u,
  ? "dq" =&gt; jwk.bytes-b64u,
  ? "qi" =&gt; jwk.bytes-b64u,
  )
jwk.EC-Key-Fields = (
  "crv" =&gt; tstr,
  "x" =&gt; jwk.bytes-b64u,
  "y" =&gt; jwk.bytes-b64u,
  ? "d" =&gt; jwk.bytes-b64u,
  )
jwk.Symmetric-Key-Fields = ("k" =&gt; jwk.bytes-b64u)
jwk.bytes-b64u = tstr .b64u bytes
eat.JC&lt;J, C&gt; = eat.JSON-ONLY&lt;J&gt; / eat.CBOR-ONLY&lt;C&gt;
eat.JSON-ONLY&lt;J&gt; = J .feature "json"
eat.CBOR-ONLY&lt;C&gt; = C .feature "cbor"
cose.COSE_KeySet = [+ cose.COSE_Key]
cose.COSE_Key = {
  1 =&gt; tstr / int,
  ? 2 =&gt; bstr,
  ? 3 =&gt; tstr / int,
  ? 4 =&gt; [+ tstr / int],
  ? 5 =&gt; bstr,
  * cose.label =&gt; cose.values,
}
cose.label = int / tstr
cose.values = any
</pre><a href="#appendix-A.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="openapi-schema">
<section id="appendix-B">
      <h2 id="name-openapi-schema">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-openapi-schema" class="section-name selfRef">OpenAPI Schema</a>
      </h2>
<p id="appendix-B-1">The OpenAPI schema for the request/response HTTP API described in <a href="#secrrapi" class="auto internal xref">Section 6.1</a> is provided below.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-2">
<pre>
openapi: '3.0.0'

info:
  title: CoSERV HTTP API Binding
  description: CoSERV HTTP API Binding, including request-response and discovery
  version: '1.0.0alpha'
paths:
  /coserv/{query}:
    get:
      summary: Query the CoSERV endpoint.
      parameters:
        - in: path
          name: query
          schema:
            type: string
            format: base64url
          required: true
          description: base64url-encoded CoSERV query
      responses:
        '200':
          description: &gt;
            A CoSERV result set has been successfully computed.
          content:
            application/coserv+cose:
              schema:
                type: string
                format: binary
                description: &gt;
                  A CoSERV result set enveloped in a COSE Sign1 object.
        '400':
          description: &gt;
            The request was malformed; e.g., the query was not valid base64url,
            or the CoSERV data item could not be successfully parsed.
          content:
            application/concise-problem-details+cbor:
              schema:
                type: string
                format: binary
                description: &gt;
                  A CBOR-encoded problem details data item.
        '406':
          description: &gt;
            The server cannot produce a response matching the list of acceptable
            values defined in the request's 'Accept' header field.  In particular,
            the client may have specified a CoSERV profile that is not understood or
            serviceable by the server.
          content:
            application/concise-problem-details+cbor:
              schema:
                type: string
                format: binary
                description: &gt;
                  A CBOR-encoded problem details data item.
  /.well-known/coserv-configuration:
    get:
      summary: Retrieve the CoSERV configuration document.
      responses:
        '200':
          description: &gt;
            The CoSERV configuration document has been successfully retrieved.
          content:
            application/coserv-discovery+json:
              schema:
                type: string
                format: binary
                description: &gt;
                  A JSON-encoded CoSERV configuration document.
            application/coserv-discovery+cbor:
              schema:
                type: string
                format: binary
                description: &gt;
                  A CBOR-encoded CoSERV configuration document.
</pre><a href="#appendix-B-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="locating-coserv-services">
<section id="appendix-C">
      <h2 id="name-locating-coserv-services">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-locating-coserv-services" class="section-name selfRef">Locating CoSERV Services</a>
      </h2>
<p id="appendix-C-1">CoSERV facilitates the conveyance of Endorsements and Reference Values to the Verifier.
The question of how the Verifier locates the CoSERV-enabled service(s) that it needs is beyond the scope of this specification.
But it is an important consideration for successful deployments.
When aggregators are used (see <a href="#secaggregation" class="auto internal xref">Section 2</a>), those might also need to locate upstream CoSERV-enabled services.
This non-normative appendix sets out some illustrative examples of how services might be located.
This list is neither exhaustive nor prescriptive.
Deployments are free to use whatever logistics are sensible.
Note that the goal here is solely one of bootstrapping.
Once the base URL of a suitable service is known, CoSERV provides in-protocol discovery mechanisms, such as the one described in <a href="#secrrapidisco" class="auto internal xref">Section 6.1.1</a>, which cater for the discovery of more specific API endpoints and capabilities.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">Some CoSERV-enabled services might exist in locations that are documented publicly by supply chain actors.
A hardware vendor, for example, might document the base URL for the service that endorses their products.
In such a case, the location would be prior knowledge within the Verifier or aggregator that needs to consume the service.
It could be hard-coded, or made available via a configuration file.<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1">The locations of suitable services might be carried within the Evidence produced by an Attester.
An example would be a specific claim within an attestation report that is reserved and documented for this purpose.
As part of the verification process, the Verifier would process this claim and use it to locate the required service(s).<a href="#appendix-C-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1">Services could be located via Manufacturer Usage Description (MUD) files as per <span>[<a href="#I-D.ietf-iotops-mud-rats" class="cite xref">I-D.ietf-iotops-mud-rats</a>]</span>.<a href="#appendix-C-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">The participants in the "Staircase meeting" at FOSDEM '25:<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-2">
<pre>
@@@@#=+++==+=+++++==+++++++++=========-========================-=======
@@@@@@@@#+*++++=+++****#########+====================================-=
*+@@@@@@%@%@%=***#*########%#####*++===============================-===
%%%%%@@%#@*@@@%%%%##%%%####%%###%#%++++=+=+================--==========
%%%%%%@@@%#%@%@@%###%#%#%%%#%%%#%%####===%%%+==================-=======
%%%%%%%@%%##%%%%%####%++=+=++++*%*=#+*++++++%#=== Mathias Brossard ====
%%%@%%%%%%%%%%%@%%####*##**#***+%%#**=*==*==*%================-========
%%%%%%@%%%%%%%%%#@###**+==%**%###%#+*+++=*+=*%=========================
%%%%%%%%%%%#%%%#*%###%###@#**%##%@#*%#++=+*#*=======================-==
@@@@@@@@%@@@#%#%%####%##%%%**###**%#+++++++++++======================--
%%@@@@@@@@%%#%%#%#==+%##%+%+=**##*%#%@@%%%***+==============-===-===-=:
%-*@%@%%%%#%%%##%==--#**##+*@@%%#*#@@@%%%%%%@%##%%==----======----=---:
%%%@@%#**%%%%%##%---#%@@%%%##**@@@%%%%%%%%@@#***%%=...-== Thomas ==-::+
=###%@@%%%%%%#*+===%#%%##%*#@@@@%%%%%%%%@@%%*+*+#=..:==== Fossati =-:**
+**+#%@@@@@@@@@@@@####*+++*@@@@@%%%@%%%%%#@%=+=--.:====================
+++**+%%@@@@@@%%%%%%%@@+#++#@@%@%%%@%%%%%@#+=-:.:==++++++++++++++++++++
+=++*#%#%@@%%%%%%#%**@+#+-+-%#%*%%%###%%%%#%%++++********++++++++++++++
++++**###=*@%%%%%%%++%*%+*==%##*#%+###@@@@%%%#===++++* Yogesh ++ ++++++
++=+++#**+=@*@@@@%#++#==+=+-%##**#*=+@@@@@%%#*----===+ Deshpande =+=+==
==+**+###++%++**@%*++#====+*##*****@%@#%%##%%*-==========+++++===+=++++
*+++++###++%=++*%#**+%===*++##***++@@%#%@%%%@%###-:::===++=---=-----:==
%++=-=%###+#====****=#===+=*=##*+%*@@%%%%%%@@%*=++#--===*==+=-+==+=-+++
%==----###=%===++*++=%*=+=***@#+***@%%*@%%%##%*##*%%@+=+==+++++++++++++
#*++----##=@*=+=**+*=*++#+=%%#*##%#*+@%@@%%%%%**%@%@@+#+**#*#####***#*+
+*+++@**+#%=%=+++++*=#++#%#+*****##*+@+++%%%%%#@@@@@@=-====-----+**++++
+*+*=%%#**#%=%@%=#++=%+***++*********%%%@%%#-==*+===++===++++++++++++++
#+**++%@%**#%@@%+#+*+%++=+=+*##*****%%%##%==-==**-+====-----:---::::--=
%%***+#%@%**%%=#*#+++%=====+*****#*+*@@+====-==%#*+-.-..-==:==.-.:::...
##**++=@%%#*#%%++#**=%-====+%%+###+++%#=====-+=%%##**+------===::=---::
#***++=+%%%#*%%==#+-+---==+*%%#@@%%++##=====-==%%%%=*++== Paul =:---===
##***+===%%@##@#%#*#=----===+++=+##*+##=====-==%%%%=*=-.. Howard .:-===
##***++==%%%%+**#%%#++-#%====+++%*++==#=====-==%%%%%%+--.:.-::--+=--+=+
##***+=+=%@%%##%##+######=++*=%=---*=+*=====--+%%%%%%+#--:.:--+**#*####
****+++==+%%@@%%%#%*########-%%=-====+*=-===-=+%%%%%%+++++++++*********
*+****++=##%%@@@%%#%+###%###%#@#+=+++==--===-=+%%%%%#+=+++--..====----=
++**+=#++#%%@+#@@@#%%####*#*##@*##%#*++=======+------++=++=--.-----=---
*%++*=+*+%#@#*@*%%#%%*###%#####+##%%=--+======+==:---+=--- Thore -===--
*++##**%=:==-#*+%#%=-=%%#%#%#%%##%*-=====-=--====--*-+-=== Sommer --=-=
-++*=%%*=%++-:#+=:*:####%#%%#%%**++=-==+---*-=*==--**+-===============+
-%#=%%%%%%@%%*%%##*%%%%%%%%%*@#%#++==---------=*+###++========+++++++++
-%@=*%%@%#%%@#@%%%%%%#@++++++@%%@#%%%%%%%---=====++++++++++++++++++++++
-%@=++*#@%#%*@++*#%%%*%*#*##@%+:%##+@@%%#%%#==========+++++++++++++++++
=%%=*==+%###+@%@%%@@%%%%####****+%#%%%%@%*###=:-========++++++++=++++++
==@==-+*##**+#%%%%#%##**###******++*%#%%##%*%#--===========++++++++++++
=-%=+*+-%#**-%@%%%@##**#*******+***%%%%##*%%%%-==++##===== Hannes +++++
+=@+*++++%**=%*+++%##+=@%%@%@@%*@%%%%%%+###+*==+=---%#==== Tschofenig +
+=@=++++*%**+%@+*=%###=-=-=-###%%@%%%#%*%#%%+==--+==%#====+=+++++++++++
*=%%==*+*#**=%@+#@@#==+=%*-----=%%#%%%%##%#%%%@=-+*%*++++++++++++++++++
#*@#+*+++#**=*=++-=+=+*#%%%%%%=-+%%%@@@%##%%%@#=+=+++++++++++++++++++++
****:::::-:::.=*++.=+**#######%%####%####*%%#%%%+++++++++++++++++++++++
*****:-::---==%+++=###+%********%%####%####@%##%%+++++++++++***********
#***##+++%#*++%++=+##*=%++#@@@@@%%%#%#####*%%##%%@*+++++++*************
#####+++*@%#+*@++*+%##+%++===+++++++++==========-=***+*****************
%%%#+***++@%@*@++*%%%%*#+===========================%%+================
%===++*++#***#@**%%%#%#+==========================%%%==================
######*****###*##*##===========================%%%#====================
#######****##*#*##**=====+++=++-----=======++%%#+======================
#########**#***##*#*#=+=======-:::::--====@%##-========================
######*=####**=#####*++++++++=-------+++@%##--=============------------
%%######@@@@@@@%++++=%====%+==----=++%%%#==---=========================
%%%%#%%###@@=**=++=------==#----+++%%%#+====-======================+===
======+##=%@++**=#-:--::---+-+++%%%#===== Ionut Mihalcea ==============
---------=+=*++%#*+=-=::---*++%%%#==================================+==
------------==%==-:::=*=*##%%%%#======*================================
===========-=##------+%%@%%%#+====================== =  /` _____ `\;,
###############*+*****@%%%#+========================   /__(^===^)__\';,
*############++++++#%%%#++==========++==============     /  :::  \   ,;
+++****##*#++=+++@%%%#+==== The Staircase ==========    |   :::   | ,;'
++++++++======++@#%#================================    '._______.'`
++++++++====++@#%#===================================  Dionna Glaze ===
</pre><a href="#appendix-D-2" class="pilcrow">¶</a>
</div>
<p id="appendix-D-3">Henk Birkholz and Jag Raman are puppeteering in the shadows.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">The authors would like to thank
Carl Wallace
for their reviews and suggestions.<a href="#appendix-D-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paul Howard</span></div>
<div dir="auto" class="left"><span class="org">Arm</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:paul.howard@arm.com" class="email">paul.howard@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Thomas.Fossati@linaro.org" class="email">Thomas.Fossati@linaro.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shefali Kamal</span></div>
<div dir="auto" class="left"><span class="org">Fujitsu</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Shefali.Kamal@fujitsu.com" class="email">Shefali.Kamal@fujitsu.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Giridhar Mandyam</span></div>
<div dir="auto" class="left"><span class="org">AMD</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gmandyam@amd.com" class="email">gmandyam@amd.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ding Ma</span></div>
<div dir="auto" class="left"><span class="org">Alibaba Cloud</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:xynnn@linux.alibaba.com" class="email">xynnn@linux.alibaba.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
