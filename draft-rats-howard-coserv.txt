



Network Working Group                                          P. Howard
Internet-Draft                                                       Arm
Intended status: Informational                                T. Fossati
Expires: 25 September 2025                                        Linaro
                                                           24 March 2025


         Concise Selector for Endorsements and Reference Values
                    draft-rats-howard-coserv-latest

Abstract

   In the Remote Attestation Procedures (RATS) architecture, Verifiers
   require Endorsements and Reference Values to assess the
   trustworthiness of Attesters.  This document specifies the Concise
   Selector for Endorsements and Reference Values (CoSERV), a structured
   query format designed to facilitate the discovery and retrieval of
   these artifacts from various providers.  CoSERV defines a query
   language that can be expressed in both JSON and CBOR formats, with a
   common CDDL schema, enabling interoperability across diverse systems.

About This Document

   This note is to be removed before publishing as an RFC.

   The latest revision of this draft can be found at
   https://paulhowardarm.github.io/draft-rats-howard-coserv/draft-rats-
   howard-coserv.html.  Status information for this document may be
   found at https://datatracker.ietf.org/doc/draft-rats-howard-coserv/.

   Source for this draft and an issue tracker can be found at
   https://github.com/paulhowardarm/draft-rats-howard-coserv.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 25 September 2025.

Copyright Notice

   Copyright (c) 2025 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Terminology and Requirements Language
       1.1.1.  Glossary
   2.  Problem Statement
   3.  CoSERV Query Language
   4.  Environment Specification
   5.  Query Structure
   6.  JSON Representation
   7.  IANA Considerations
   8.  References
     8.1.  Normative References
     8.2.  Informative References
   Appendix A.  CoSERV CDDL
   Acknowledgments
   Authors' Addresses

1.  Introduction

   Remote Attestation Procedures (RATS) enable Relying Parties to
   evaluate the trustworthiness of remote Attesters by appraising
   Evidence.  This appraisal necessitates access to Endorsements and
   Reference Values, which are often distributed across multiple
   providers, including hardware manufacturers, firmware developers, and
   software vendors.  The lack of standardized methods for querying and
   retrieving these artifacts poses challenges in achieving seamless
   interoperability.

   The Concise Selector for Endorsements and Reference Values (CoSERV)
   addresses this challenge by defining a query language that allows
   Verifiers to specify the environment characteristics of the desired
   artifacts.  This facilitates the efficient discovery and retrieval of
   relevant Endorsements and Reference Values from providers.

1.1.  Terminology and Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   This document uses terms and concepts defined by the RATS
   architecture.  For a complete glossary, see Section 4 of [RFC9334].

   This document uses the terms _"actual state"_ and _"reference state"_
   as defined in Section 2 of [I-D.ietf-rats-endorsements].

   The terminology from CBOR [STD94], CDDL [RFC8610] and COSE [STD96]
   applies; in particular, CBOR diagnostic notation is defined in
   Section 8 of [STD94] and Appendix G of [RFC8610].  Terms and concepts
   are always referenced as proper nouns, i.e., with Capital Letters.

1.1.1.  Glossary

   This document uses the following terms:

   *  *Attester*: An entity that produces attestation Evidence about its
      identity, software, and operational state.

   *  *Verifier*: An entity that appraises Evidence using Endorsements,
      Reference Values, and appraisal policies to produce Attestation
      Results.

   *  *Endorsement*: A secure statement from an entity (typically a
      manufacturer) vouching for the integrity of an Attester's signing
      capability.

   *  *Reference Value*: Known-good measurements or configurations
      against which the Verifier compares the Attester's Evidence.

   *  *Environment*: The context in which measurements are applicable,
      encompassing attributes such as hardware, software, and
      configuration settings.

   *  *CoRIM*: Concise Reference Integrity Manifest, a format for
      conveying Endorsements and Reference Values.

   *  *CoSERV*: Concise Selector for Endorsements and Reference Values,
      the query format specified in this document.

2.  Problem Statement

   As outlined in the RATS architecture [RFC9334], Verifiers rely on
   Endorsements and Reference Values to assess attestation Evidence.
   These artifacts are often maintained by different providers, leading
   to challenges in their discovery and retrieval.  The absence of a
   standardized query mechanism results in:

   *  *Interoperability Issues*: Diverse data formats and access methods
      hinder seamless integration between Verifiers and artifact
      providers.

   *  *Increased Complexity*: Verifiers must implement multiple
      interfaces to interact with various providers, complicating the
      attestation process.

   *  *Latency in Appraisal*: Delays in retrieving necessary artifacts
      can impede timely attestation, affecting system performance and
      security.

   CoSERV aims to mitigate these issues by providing a unified query
   format that standardizes the selection criteria for Endorsements and
   Reference Values, facilitating efficient and interoperable
   interactions between Verifiers and providers.

3.  CoSERV Query Language

   The CoSERV query language enables Verifiers to specify the desired
   characteristics of Endorsements and Reference Values based on the
   environment in which they are applicable.  This section details the
   structure of CoSERV queries, which can be serialized in both JSON and
   CBOR formats, adhering to a common CDDL schema.

4.  Environment Specification

   An environment in CoSERV encompasses attributes that define the
   context for which Endorsements or Reference Values are relevant.
   These attributes include:

   *  *Class*: The general category of the environment (e.g., hardware,
      software, virtual machine).

   *  *Instance*: Specific details identifying a unique environment
      instance, such as serial numbers or unique identifiers.

   *  *Group*: A collection of related environments sharing common
      characteristics.

5.  Query Structure

   A CoSERV query comprises the following elements:

   *  *Environment*: An object detailing the environment attributes as
      specified above.

   *  *Artifact Type*: A field indicating whether the query is for an
      Endorsement, Reference Value, or both.

   *  *Version Constraints*: Optional parameters specifying acceptable
      version ranges for the requested artifacts.

   *  *Security Level*: Optional attribute denoting the required
      security assurance level of the artifacts.

6.  JSON Representation

   Below is an example of a CoSERV query in CBOR EDN format:

   {
     0: 2,
     1: "tag:example.com,2025:cc-platform#1.0.0",
     2: {
       0: [
         {
           0: 560(h'00112233'),
           1: "Example Vendor",
           2: "Example Model"
         }
       ]
     }
   }

7.  IANA Considerations

   This document has no IANA actions.

8.  References

8.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8610]  Birkholz, H., Vigano, C., and C. Bormann, "Concise Data
              Definition Language (CDDL): A Notational Convention to
              Express Concise Binary Object Representation (CBOR) and
              JSON Data Structures", RFC 8610, DOI 10.17487/RFC8610,
              June 2019, <https://www.rfc-editor.org/rfc/rfc8610>.

   [RFC9334]  Birkholz, H., Thaler, D., Richardson, M., Smith, N., and
              W. Pan, "Remote ATtestation procedureS (RATS)
              Architecture", RFC 9334, DOI 10.17487/RFC9334, January
              2023, <https://www.rfc-editor.org/rfc/rfc9334>.

   [STD94]    Bormann, C. and P. Hoffman, "Concise Binary Object
              Representation (CBOR)", STD 94, RFC 8949,
              DOI 10.17487/RFC8949, December 2020,
              <https://www.rfc-editor.org/rfc/rfc8949>.

   [STD96]    Schaad, J., "CBOR Object Signing and Encryption (COSE):
              Structures and Process", STD 96, RFC 9052,
              DOI 10.17487/RFC9052, August 2022,
              <https://www.rfc-editor.org/rfc/rfc9052>.

8.2.  Informative References

   [I-D.ietf-rats-endorsements]
              Thaler, D., Birkholz, H., and T. Fossati, "RATS
              Endorsements", Work in Progress, Internet-Draft, draft-
              ietf-rats-endorsements-06, 3 March 2025,
              <https://datatracker.ietf.org/doc/html/draft-ietf-rats-
              endorsements-06>.

Appendix A.  CoSERV CDDL

   coserv = {
     &(artifact-type: 0) => artifact-type
     &(profile: 1) => profile-type
     &(environment-selector: 2) => environment-selector-map
   }

   artifact-type = &(endorsed-values: 0)
                   / &(trust-anchors: 1)
                   / &(reference-values: 2)

   profile-type = oid-type / ~uri

Acknowledgments

   TODO acknowledge.

Authors' Addresses

   Paul Howard
   Arm
   Email: paul.howard@arm.com


   Thomas Fossati
   Linaro
   Email: Thomas.Fossati@linaro.org
